<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 23 Statistical design of t-tests | JABSTB: Statistical Design and Analysis of Experiments with R</title>
  <meta name="description" content="Experimental biostatistics using R." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 23 Statistical design of t-tests | JABSTB: Statistical Design and Analysis of Experiments with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Experimental biostatistics using R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 23 Statistical design of t-tests | JABSTB: Statistical Design and Analysis of Experiments with R" />
  
  <meta name="twitter:description" content="Experimental biostatistics using R." />
  

<meta name="author" content="TJ Murphy PhD, Department of Pharmacology and Chemical Biology, School of Medicine, Emory University, Atlanta, GA biostats538@gmail.com" />


<meta name="date" content="2020-01-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ttests.html"/>
<link rel="next" href="simcorrelation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">JABSTB</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i><b>1</b> About the author and book</a></li>
<li class="chapter" data-level="2" data-path="history.html"><a href="history.html"><i class="fa fa-check"></i><b>2</b> A Brief History of Experimental Design</a></li>
<li class="chapter" data-level="3" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i><b>3</b> Installing and Understanding the software</a><ul>
<li class="chapter" data-level="3.1" data-path="software.html"><a href="software.html#spring-2020-term-versions"><i class="fa fa-check"></i><b>3.1</b> Spring 2020 term versions</a><ul>
<li class="chapter" data-level="3.1.1" data-path="software.html"><a href="software.html#what-are-these"><i class="fa fa-check"></i><b>3.1.1</b> What are these?</a></li>
<li class="chapter" data-level="3.1.2" data-path="software.html"><a href="software.html#rule-1-install-r-first-install-rstudio-second"><i class="fa fa-check"></i><b>3.1.2</b> Rule 1: Install R first, install RStudio second</a></li>
<li class="chapter" data-level="3.1.3" data-path="software.html"><a href="software.html#rule-2-dont-pay"><i class="fa fa-check"></i><b>3.1.3</b> Rule 2: Don’t pay!</a></li>
<li class="chapter" data-level="3.1.4" data-path="software.html"><a href="software.html#rule-3-dont-compile"><i class="fa fa-check"></i><b>3.1.4</b> Rule 3: Don’t compile!</a></li>
<li class="chapter" data-level="3.1.5" data-path="software.html"><a href="software.html#rule-4-install-the-right-software-for-your-machine"><i class="fa fa-check"></i><b>3.1.5</b> Rule 4: Install the right software for your machine</a></li>
<li class="chapter" data-level="3.1.6" data-path="software.html"><a href="software.html#rule-5-use-this-installation-guide"><i class="fa fa-check"></i><b>3.1.6</b> Rule 5: Use this installation guide</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="software.html"><a href="software.html#after-installation"><i class="fa fa-check"></i><b>3.2</b> After installation</a><ul>
<li class="chapter" data-level="3.2.1" data-path="software.html"><a href="software.html#what-is-r"><i class="fa fa-check"></i><b>3.2.1</b> What is R?</a></li>
<li class="chapter" data-level="3.2.2" data-path="software.html"><a href="software.html#r-packages"><i class="fa fa-check"></i><b>3.2.2</b> R packages</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="software.html"><a href="software.html#important-avoid-compiling"><i class="fa fa-check"></i><b>3.3</b> Important: Avoid compiling</a><ul>
<li class="chapter" data-level="3.3.1" data-path="software.html"><a href="software.html#reasons-not-to-compile"><i class="fa fa-check"></i><b>3.3.1</b> Reasons not to compile</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i><b>4</b> Start Learning R</a><ul>
<li class="chapter" data-level="4.1" data-path="getting-started.html"><a href="getting-started.html#digging-in-with-rrstudio"><i class="fa fa-check"></i><b>4.1</b> Digging in with R/RStudio</a></li>
<li class="chapter" data-level="4.2" data-path="getting-started.html"><a href="getting-started.html#the-tidyverse-package"><i class="fa fa-check"></i><b>4.2</b> The tidyverse package</a><ul>
<li class="chapter" data-level="4.2.1" data-path="getting-started.html"><a href="getting-started.html#do-swirlstats"><i class="fa fa-check"></i><b>4.2.1</b> Do swirlstats</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="getting-started.html"><a href="getting-started.html#other-resources"><i class="fa fa-check"></i><b>4.3</b> Other resources</a><ul>
<li class="chapter" data-level="4.3.1" data-path="getting-started.html"><a href="getting-started.html#internet-search"><i class="fa fa-check"></i><b>4.3.1</b> Internet search</a></li>
<li class="chapter" data-level="4.3.2" data-path="getting-started.html"><a href="getting-started.html#help-documents"><i class="fa fa-check"></i><b>4.3.2</b> Help Documents</a></li>
<li class="chapter" data-level="4.3.3" data-path="getting-started.html"><a href="getting-started.html#package-vignettes"><i class="fa fa-check"></i><b>4.3.3</b> Package Vignettes</a></li>
<li class="chapter" data-level="4.3.4" data-path="getting-started.html"><a href="getting-started.html#people"><i class="fa fa-check"></i><b>4.3.4</b> People</a></li>
<li class="chapter" data-level="4.3.5" data-path="getting-started.html"><a href="getting-started.html#typos"><i class="fa fa-check"></i><b>4.3.5</b> typos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="philos.html"><a href="philos.html"><i class="fa fa-check"></i><b>5</b> What is your philosophy?</a><ul>
<li class="chapter" data-level="5.1" data-path="philos.html"><a href="philos.html#exploration-and-uncertainty"><i class="fa fa-check"></i><b>5.1</b> Exploration and uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bigpic.html"><a href="bigpic.html"><i class="fa fa-check"></i><b>6</b> Stats: The Big Picture</a><ul>
<li class="chapter" data-level="6.1" data-path="bigpic.html"><a href="bigpic.html#what-are-experimental-statistics"><i class="fa fa-check"></i><b>6.1</b> What are experimental statistics?</a><ul>
<li class="chapter" data-level="6.1.1" data-path="bigpic.html"><a href="bigpic.html#descriptive-modeling"><i class="fa fa-check"></i><b>6.1.1</b> Descriptive modeling</a></li>
<li class="chapter" data-level="6.1.2" data-path="bigpic.html"><a href="bigpic.html#statistical-inference"><i class="fa fa-check"></i><b>6.1.2</b> Statistical inference</a></li>
<li class="chapter" data-level="6.1.3" data-path="bigpic.html"><a href="bigpic.html#experimental-design"><i class="fa fa-check"></i><b>6.1.3</b> Experimental design</a></li>
<li class="chapter" data-level="6.1.4" data-path="bigpic.html"><a href="bigpic.html#statistics-as-an-anti-bias-framework"><i class="fa fa-check"></i><b>6.1.4</b> Statistics as an anti-bias framework</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>7</b> Statistical Sampling</a><ul>
<li class="chapter" data-level="7.1" data-path="sampling.html"><a href="sampling.html#experimental-units"><i class="fa fa-check"></i><b>7.1</b> Experimental units</a><ul>
<li class="chapter" data-level="7.1.1" data-path="sampling.html"><a href="sampling.html#a-simple-test-to-define-the-experimental-unit"><i class="fa fa-check"></i><b>7.1.1</b> A simple test to define the experimental unit</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sampling.html"><a href="sampling.html#independent-replicates"><i class="fa fa-check"></i><b>7.2</b> Independent Replicates</a><ul>
<li class="chapter" data-level="7.2.1" data-path="sampling.html"><a href="sampling.html#a-simple-test-for-independence"><i class="fa fa-check"></i><b>7.2.1</b> A simple test for independence</a></li>
<li class="chapter" data-level="7.2.2" data-path="sampling.html"><a href="sampling.html#some-replication-examples"><i class="fa fa-check"></i><b>7.2.2</b> Some replication examples</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sampling.html"><a href="sampling.html#random-process"><i class="fa fa-check"></i><b>7.3</b> Random process</a></li>
<li class="chapter" data-level="7.4" data-path="sampling.html"><a href="sampling.html#statistically-valid-samples"><i class="fa fa-check"></i><b>7.4</b> Statistically valid samples</a><ul>
<li class="chapter" data-level="7.4.1" data-path="sampling.html"><a href="sampling.html#select-random-subjects"><i class="fa fa-check"></i><b>7.4.1</b> Select random subjects</a></li>
<li class="chapter" data-level="7.4.2" data-path="sampling.html"><a href="sampling.html#randomize-to-sequence"><i class="fa fa-check"></i><b>7.4.2</b> Randomize to sequence</a></li>
<li class="chapter" data-level="7.4.3" data-path="sampling.html"><a href="sampling.html#randomize-to-location"><i class="fa fa-check"></i><b>7.4.3</b> Randomize to location</a></li>
<li class="chapter" data-level="7.4.4" data-path="sampling.html"><a href="sampling.html#randomize-to-block"><i class="fa fa-check"></i><b>7.4.4</b> Randomize to block</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sampling.html"><a href="sampling.html#independence-of-replicates"><i class="fa fa-check"></i><b>7.5</b> Independence of replicates</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>8</b> Data Classification</a><ul>
<li class="chapter" data-level="8.1" data-path="data.html"><a href="data.html#dependent-and-independent-variables"><i class="fa fa-check"></i><b>8.1</b> Dependent and independent variables</a><ul>
<li class="chapter" data-level="8.1.1" data-path="data.html"><a href="data.html#statistical-notation"><i class="fa fa-check"></i><b>8.1.1</b> Statistical notation</a></li>
<li class="chapter" data-level="8.1.2" data-path="data.html"><a href="data.html#when-there-is-no-independent-variable"><i class="fa fa-check"></i><b>8.1.2</b> When there is no independent variable</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="data.html"><a href="data.html#discrete-or-continuous-variables"><i class="fa fa-check"></i><b>8.2</b> Discrete or continuous variables</a><ul>
<li class="chapter" data-level="8.2.1" data-path="data.html"><a href="data.html#measured-variables"><i class="fa fa-check"></i><b>8.2.1</b> Measured variables</a></li>
<li class="chapter" data-level="8.2.2" data-path="data.html"><a href="data.html#discrete-categorical-and-ordinal-variables"><i class="fa fa-check"></i><b>8.2.2</b> Discrete categorical and ordinal variables</a></li>
<li class="chapter" data-level="8.2.3" data-path="data.html"><a href="data.html#rescaling-variables"><i class="fa fa-check"></i><b>8.2.3</b> Rescaling variables</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="data.html"><a href="data.html#working-with-data"><i class="fa fa-check"></i><b>8.3</b> Working with data</a><ul>
<li class="chapter" data-level="8.3.1" data-path="data.html"><a href="data.html#entering-data"><i class="fa fa-check"></i><b>8.3.1</b> Entering data</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="data.html"><a href="data.html#summary"><i class="fa fa-check"></i><b>8.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="dispersion.html"><a href="dispersion.html"><i class="fa fa-check"></i><b>9</b> Variability, Accuracy and Precision</a><ul>
<li class="chapter" data-level="9.0.1" data-path="dispersion.html"><a href="dispersion.html#data-are-messy"><i class="fa fa-check"></i><b>9.0.1</b> Data are messy</a></li>
<li class="chapter" data-level="9.1" data-path="dispersion.html"><a href="dispersion.html#illustration-of-a-model-with-error"><i class="fa fa-check"></i><b>9.1</b> Illustration of a model with error</a></li>
<li class="chapter" data-level="9.2" data-path="dispersion.html"><a href="dispersion.html#variance-quantifying-variation-by-least-squares"><i class="fa fa-check"></i><b>9.2</b> Variance: Quantifying variation by least squares</a><ul>
<li class="chapter" data-level="9.2.1" data-path="dispersion.html"><a href="dispersion.html#definition-of-variance"><i class="fa fa-check"></i><b>9.2.1</b> Definition of variance</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="dispersion.html"><a href="dispersion.html#standard-deviation"><i class="fa fa-check"></i><b>9.3</b> Standard deviation</a><ul>
<li class="chapter" data-level="9.3.1" data-path="dispersion.html"><a href="dispersion.html#what-does-the-standard-deviation-tell-us"><i class="fa fa-check"></i><b>9.3.1</b> What does the standard deviation tell us</a></li>
<li class="chapter" data-level="9.3.2" data-path="dispersion.html"><a href="dispersion.html#ways-of-describing-sample-variability"><i class="fa fa-check"></i><b>9.3.2</b> Ways of describing sample variability</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="dispersion.html"><a href="dispersion.html#precision-and-accuracy"><i class="fa fa-check"></i><b>9.4</b> Precision and Accuracy</a></li>
<li class="chapter" data-level="9.5" data-path="dispersion.html"><a href="dispersion.html#standard-error"><i class="fa fa-check"></i><b>9.5</b> Standard error</a><ul>
<li class="chapter" data-level="9.5.1" data-path="dispersion.html"><a href="dispersion.html#what-exactly-does-the-standard-error-represent"><i class="fa fa-check"></i><b>9.5.1</b> What exactly does the standard error represent?</a></li>
<li class="chapter" data-level="9.5.2" data-path="dispersion.html"><a href="dispersion.html#should-i-use-sd-or-sem"><i class="fa fa-check"></i><b>9.5.2</b> “Should I use SD or SEM?”</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="dispersion.html"><a href="dispersion.html#confidence-intervals"><i class="fa fa-check"></i><b>9.6</b> Confidence intervals</a><ul>
<li class="chapter" data-level="9.6.1" data-path="dispersion.html"><a href="dispersion.html#ci-definition"><i class="fa fa-check"></i><b>9.6.1</b> CI Definition</a></li>
<li class="chapter" data-level="9.6.2" data-path="dispersion.html"><a href="dispersion.html#evaluating-confidence-intervals"><i class="fa fa-check"></i><b>9.6.2</b> Evaluating confidence intervals</a></li>
<li class="chapter" data-level="9.6.3" data-path="dispersion.html"><a href="dispersion.html#ci-simulation-tools"><i class="fa fa-check"></i><b>9.6.3</b> CI Simulation tools</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="dispersion.html"><a href="dispersion.html#key-take-aways"><i class="fa fa-check"></i><b>9.7</b> Key take aways</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="hypotheses.html"><a href="hypotheses.html"><i class="fa fa-check"></i><b>10</b> Framing statistical hypotheses</a><ul>
<li class="chapter" data-level="10.1" data-path="hypotheses.html"><a href="hypotheses.html#the-decision-process"><i class="fa fa-check"></i><b>10.1</b> The decision process</a></li>
<li class="chapter" data-level="10.2" data-path="hypotheses.html"><a href="hypotheses.html#popper-and-falsification"><i class="fa fa-check"></i><b>10.2</b> Popper and falsification</a></li>
<li class="chapter" data-level="10.3" data-path="hypotheses.html"><a href="hypotheses.html#statistical-hypothesis-rubric"><i class="fa fa-check"></i><b>10.3</b> Statistical hypothesis rubric</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="error.html"><a href="error.html"><i class="fa fa-check"></i><b>11</b> Error</a><ul>
<li class="chapter" data-level="11.1" data-path="error.html"><a href="error.html#setting-type-1-and-type-2-error-thresholds"><i class="fa fa-check"></i><b>11.1</b> Setting type 1 and type 2 error thresholds</a><ul>
<li class="chapter" data-level="11.1.1" data-path="error.html"><a href="error.html#setting-alpha-the-type-1-error"><i class="fa fa-check"></i><b>11.1.1</b> Setting alpha-the type 1 error</a></li>
<li class="chapter" data-level="11.1.2" data-path="error.html"><a href="error.html#power-setting-beta-the-type-2-error"><i class="fa fa-check"></i><b>11.1.2</b> Power: Setting beta-the type 2 error</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="error.html"><a href="error.html#striking-the-right-balance"><i class="fa fa-check"></i><b>11.2</b> Striking the right balance</a></li>
<li class="chapter" data-level="11.3" data-path="error.html"><a href="error.html#false-discovery-rate"><i class="fa fa-check"></i><b>11.3</b> False discovery rate</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="pvalues.html"><a href="pvalues.html"><i class="fa fa-check"></i><b>12</b> P Values</a><ul>
<li class="chapter" data-level="12.1" data-path="pvalues.html"><a href="pvalues.html#definition"><i class="fa fa-check"></i><b>12.1</b> Definition</a></li>
<li class="chapter" data-level="12.2" data-path="pvalues.html"><a href="pvalues.html#test-statistics-come-from-null-distributions"><i class="fa fa-check"></i><b>12.2</b> Test statistics come from null distributions</a><ul>
<li class="chapter" data-level="12.2.1" data-path="pvalues.html"><a href="pvalues.html#p-value-behavior"><i class="fa fa-check"></i><b>12.2.1</b> P-value behavior</a></li>
<li class="chapter" data-level="12.2.2" data-path="pvalues.html"><a href="pvalues.html#p-values-and-the-decision-process"><i class="fa fa-check"></i><b>12.2.2</b> P-values and the decision process</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="pvalues.html"><a href="pvalues.html#a-blood-glucose-p-value"><i class="fa fa-check"></i><b>12.3</b> A blood glucose p-value</a></li>
<li class="chapter" data-level="12.4" data-path="pvalues.html"><a href="pvalues.html#how-p-values-should-be-interpreted"><i class="fa fa-check"></i><b>12.4</b> How p-values should be interpreted</a></li>
<li class="chapter" data-level="12.5" data-path="pvalues.html"><a href="pvalues.html#interpretation"><i class="fa fa-check"></i><b>12.5</b> Interpretation</a></li>
<li class="chapter" data-level="12.6" data-path="pvalues.html"><a href="pvalues.html#criticisms-of-p-values"><i class="fa fa-check"></i><b>12.6</b> Criticisms of p-values</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="jaxwest7.html"><a href="jaxwest7.html"><i class="fa fa-check"></i><b>13</b> Reproducible Data Munging in R</a><ul>
<li class="chapter" data-level="13.1" data-path="jaxwest7.html"><a href="jaxwest7.html#jaxwest7-glucose-data"><i class="fa fa-check"></i><b>13.1</b> Jaxwest7 glucose data</a><ul>
<li class="chapter" data-level="13.1.1" data-path="jaxwest7.html"><a href="jaxwest7.html#inspect-the-jaxwest7-data"><i class="fa fa-check"></i><b>13.1.1</b> Inspect the Jaxwest7 data</a></li>
<li class="chapter" data-level="13.1.2" data-path="jaxwest7.html"><a href="jaxwest7.html#munge-the-glucose-concentration-data-into-r"><i class="fa fa-check"></i><b>13.1.2</b> Munge the glucose concentration data into R</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="jaxwest7.html"><a href="jaxwest7.html#explore-the-jaxwest7-data"><i class="fa fa-check"></i><b>13.2</b> Explore the Jaxwest7 data</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="binomial.html"><a href="binomial.html"><i class="fa fa-check"></i><b>14</b> The Binomial Distribution</a><ul>
<li class="chapter" data-level="14.1" data-path="binomial.html"><a href="binomial.html#dbinom"><i class="fa fa-check"></i><b>14.1</b> dbinom</a></li>
<li class="chapter" data-level="14.2" data-path="binomial.html"><a href="binomial.html#pbinom"><i class="fa fa-check"></i><b>14.2</b> pbinom</a></li>
<li class="chapter" data-level="14.3" data-path="binomial.html"><a href="binomial.html#qbinom"><i class="fa fa-check"></i><b>14.3</b> qbinom</a></li>
<li class="chapter" data-level="14.4" data-path="binomial.html"><a href="binomial.html#rbinom"><i class="fa fa-check"></i><b>14.4</b> rbinom</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="poisson.html"><a href="poisson.html"><i class="fa fa-check"></i><b>15</b> The Poisson Distribution</a><ul>
<li class="chapter" data-level="15.1" data-path="poisson.html"><a href="poisson.html#poisson-events"><i class="fa fa-check"></i><b>15.1</b> Poisson Events</a></li>
<li class="chapter" data-level="15.2" data-path="poisson.html"><a href="poisson.html#dpois"><i class="fa fa-check"></i><b>15.2</b> dpois</a></li>
<li class="chapter" data-level="15.3" data-path="poisson.html"><a href="poisson.html#ppois"><i class="fa fa-check"></i><b>15.3</b> ppois</a></li>
<li class="chapter" data-level="15.4" data-path="poisson.html"><a href="poisson.html#rpois"><i class="fa fa-check"></i><b>15.4</b> rpois</a></li>
<li class="chapter" data-level="15.5" data-path="poisson.html"><a href="poisson.html#overdispersion"><i class="fa fa-check"></i><b>15.5</b> Overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="normal.html"><a href="normal.html"><i class="fa fa-check"></i><b>16</b> The Normal Distribution</a><ul>
<li class="chapter" data-level="16.0.1" data-path="normal.html"><a href="normal.html#the-standard-normal"><i class="fa fa-check"></i><b>16.0.1</b> The Standard Normal</a></li>
<li class="chapter" data-level="16.1" data-path="normal.html"><a href="normal.html#dnorm"><i class="fa fa-check"></i><b>16.1</b> dnorm</a></li>
<li class="chapter" data-level="16.2" data-path="normal.html"><a href="normal.html#pnorm"><i class="fa fa-check"></i><b>16.2</b> pnorm</a><ul>
<li class="chapter" data-level="" data-path="normal.html"><a href="normal.html#calculating-p-values-using-pnorm"><i class="fa fa-check"></i>Calculating “p-values”" using pnorm</a></li>
<li class="chapter" data-level="" data-path="normal.html"><a href="normal.html#calculating-percentiles-using-pnorm"><i class="fa fa-check"></i>Calculating percentiles using pnorm</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="normal.html"><a href="normal.html#qnorm"><i class="fa fa-check"></i><b>16.3</b> qnorm</a></li>
<li class="chapter" data-level="16.4" data-path="normal.html"><a href="normal.html#rnorm"><i class="fa fa-check"></i><b>16.4</b> rnorm</a><ul>
<li class="chapter" data-level="16.4.1" data-path="normal.html"><a href="normal.html#plotting-histograms-of-some-rnorm-samples"><i class="fa fa-check"></i><b>16.4.1</b> Plotting histograms of some rnorm samples</a></li>
<li class="chapter" data-level="16.4.2" data-path="normal.html"><a href="normal.html#bins-and-binwidth"><i class="fa fa-check"></i><b>16.4.2</b> Bins and Binwidth</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="categorical.html"><a href="categorical.html"><i class="fa fa-check"></i><b>17</b> Statistics for Categorical Data</a><ul>
<li class="chapter" data-level="17.1" data-path="categorical.html"><a href="categorical.html#types-of-categorical-data"><i class="fa fa-check"></i><b>17.1</b> Types of categorical data</a><ul>
<li class="chapter" data-level="17.1.1" data-path="categorical.html"><a href="categorical.html#proportions"><i class="fa fa-check"></i><b>17.1.1</b> Proportions</a></li>
<li class="chapter" data-level="17.1.2" data-path="categorical.html"><a href="categorical.html#frequencies"><i class="fa fa-check"></i><b>17.1.2</b> Frequencies</a></li>
<li class="chapter" data-level="17.1.3" data-path="categorical.html"><a href="categorical.html#associations"><i class="fa fa-check"></i><b>17.1.3</b> Associations</a></li>
<li class="chapter" data-level="17.1.4" data-path="categorical.html"><a href="categorical.html#statistics-covered-here"><i class="fa fa-check"></i><b>17.1.4</b> Statistics Covered Here</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="categorical.html"><a href="categorical.html#exact-v-asymptotic-calculations-of-p-values"><i class="fa fa-check"></i><b>17.2</b> Exact v Asymptotic Calculations of p-values</a><ul>
<li class="chapter" data-level="17.2.1" data-path="categorical.html"><a href="categorical.html#choosing-exact-or-asymptotic"><i class="fa fa-check"></i><b>17.2.1</b> Choosing exact or asymptotic</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="categorical.html"><a href="categorical.html#overview-of-the-types-of-hypothesis-testing"><i class="fa fa-check"></i><b>17.3</b> Overview of the types of hypothesis testing</a><ul>
<li class="chapter" data-level="17.3.1" data-path="categorical.html"><a href="categorical.html#proportion-analysis"><i class="fa fa-check"></i><b>17.3.1</b> Proportion analysis</a></li>
<li class="chapter" data-level="17.3.2" data-path="categorical.html"><a href="categorical.html#goodness-of-fit-testing"><i class="fa fa-check"></i><b>17.3.2</b> Goodness of fit testing</a></li>
<li class="chapter" data-level="17.3.3" data-path="categorical.html"><a href="categorical.html#contingency-analysis"><i class="fa fa-check"></i><b>17.3.3</b> Contingency Analysis</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="categorical.html"><a href="categorical.html#comparing-proportions"><i class="fa fa-check"></i><b>17.4</b> Comparing proportions</a><ul>
<li class="chapter" data-level="17.4.1" data-path="categorical.html"><a href="categorical.html#a-mouse-t-cell-pilot-experiment-the-cytokine-inducible-antigen-gradstudin"><i class="fa fa-check"></i><b>17.4.1</b> A Mouse T Cell Pilot Experiment: The Cytokine-inducible antigen gradstudin</a></li>
<li class="chapter" data-level="17.4.2" data-path="categorical.html"><a href="categorical.html#calculating-proportions"><i class="fa fa-check"></i><b>17.4.2</b> Calculating Proportions</a></li>
<li class="chapter" data-level="17.4.3" data-path="categorical.html"><a href="categorical.html#what-a-proportion-estimates"><i class="fa fa-check"></i><b>17.4.3</b> What A Proportion Estimates</a></li>
<li class="chapter" data-level="17.4.4" data-path="categorical.html"><a href="categorical.html#confidence-intervals-of-proportions"><i class="fa fa-check"></i><b>17.4.4</b> Confidence Intervals of Proportions</a></li>
<li class="chapter" data-level="17.4.5" data-path="categorical.html"><a href="categorical.html#a-one-sample-proportion-test"><i class="fa fa-check"></i><b>17.4.5</b> A One-Sample Proportion Test</a></li>
<li class="chapter" data-level="17.4.6" data-path="categorical.html"><a href="categorical.html#comparing-two-proportions"><i class="fa fa-check"></i><b>17.4.6</b> Comparing Two Proportions</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="categorical.html"><a href="categorical.html#exact-tests-for-two-proportions"><i class="fa fa-check"></i><b>17.5</b> Exact tests for two proportions</a></li>
<li class="chapter" data-level="17.6" data-path="categorical.html"><a href="categorical.html#goodness-of-fit-tests"><i class="fa fa-check"></i><b>17.6</b> Goodness of fit Tests</a><ul>
<li class="chapter" data-level="17.6.1" data-path="categorical.html"><a href="categorical.html#an-exact-goodness-of-fit-test"><i class="fa fa-check"></i><b>17.6.1</b> An Exact Goodness of Fit test</a></li>
<li class="chapter" data-level="17.6.2" data-path="categorical.html"><a href="categorical.html#an-approximate-goodness-of-fit-test"><i class="fa fa-check"></i><b>17.6.2</b> An Approximate Goodness of Fit test</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="categorical.html"><a href="categorical.html#contingency-testing"><i class="fa fa-check"></i><b>17.7</b> Contingency Testing</a><ul>
<li class="chapter" data-level="17.7.1" data-path="categorical.html"><a href="categorical.html#intepretation-of-contingency-results"><i class="fa fa-check"></i><b>17.7.1</b> Intepretation of Contingency Results</a></li>
<li class="chapter" data-level="17.7.2" data-path="categorical.html"><a href="categorical.html#write-up-3"><i class="fa fa-check"></i><b>17.7.2</b> Write Up</a></li>
<li class="chapter" data-level="17.7.3" data-path="categorical.html"><a href="categorical.html#interpretation-of-chi-square-output"><i class="fa fa-check"></i><b>17.7.3</b> Interpretation of chi-square output</a></li>
<li class="chapter" data-level="17.7.4" data-path="categorical.html"><a href="categorical.html#write-up-4"><i class="fa fa-check"></i><b>17.7.4</b> Write Up</a></li>
<li class="chapter" data-level="17.7.5" data-path="categorical.html"><a href="categorical.html#which-contingency-test-is-best"><i class="fa fa-check"></i><b>17.7.5</b> Which contingency test is best?</a></li>
<li class="chapter" data-level="17.7.6" data-path="categorical.html"><a href="categorical.html#higher-dimension-contingency-analysis"><i class="fa fa-check"></i><b>17.7.6</b> Higher dimension contingency analysis</a></li>
<li class="chapter" data-level="17.7.7" data-path="categorical.html"><a href="categorical.html#other-experimental-designs-involving-categorical-data"><i class="fa fa-check"></i><b>17.7.7</b> Other experimental designs involving categorical data</a></li>
</ul></li>
<li class="chapter" data-level="17.8" data-path="categorical.html"><a href="categorical.html#doing-a-priori-power-analysis-for-proportion-tests"><i class="fa fa-check"></i><b>17.8</b> Doing <em>a priori</em> power analysis for proportion tests</a></li>
<li class="chapter" data-level="17.9" data-path="categorical.html"><a href="categorical.html#power-analysis-functions-for-proportion-tests"><i class="fa fa-check"></i><b>17.9</b> Power analysis functions for proportion tests</a></li>
<li class="chapter" data-level="17.10" data-path="categorical.html"><a href="categorical.html#graphing-proportions"><i class="fa fa-check"></i><b>17.10</b> Graphing Proportions</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="chisquare.html"><a href="chisquare.html"><i class="fa fa-check"></i><b>18</b> The Chi-square Distribution</a><ul>
<li class="chapter" data-level="18.1" data-path="chisquare.html"><a href="chisquare.html#background"><i class="fa fa-check"></i><b>18.1</b> Background</a></li>
<li class="chapter" data-level="18.2" data-path="chisquare.html"><a href="chisquare.html#dchisq"><i class="fa fa-check"></i><b>18.2</b> dchisq</a></li>
<li class="chapter" data-level="18.3" data-path="chisquare.html"><a href="chisquare.html#pchisq"><i class="fa fa-check"></i><b>18.3</b> pchisq</a><ul>
<li class="chapter" data-level="18.3.1" data-path="chisquare.html"><a href="chisquare.html#calculating-p-values-from-pchisq"><i class="fa fa-check"></i><b>18.3.1</b> Calculating p-values from pchisq</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="chisquare.html"><a href="chisquare.html#qchisq"><i class="fa fa-check"></i><b>18.4</b> qchisq</a></li>
<li class="chapter" data-level="18.5" data-path="chisquare.html"><a href="chisquare.html#rchisq"><i class="fa fa-check"></i><b>18.5</b> rchisq</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="nonparametrics.html"><a href="nonparametrics.html"><i class="fa fa-check"></i><b>19</b> Nonparametric Statistical Tests</a><ul>
<li class="chapter" data-level="19.1" data-path="nonparametrics.html"><a href="nonparametrics.html#experiments-involving-discrete-data"><i class="fa fa-check"></i><b>19.1</b> Experiments involving discrete data</a></li>
<li class="chapter" data-level="19.2" data-path="nonparametrics.html"><a href="nonparametrics.html#deviant-data"><i class="fa fa-check"></i><b>19.2</b> Deviant Data</a></li>
<li class="chapter" data-level="19.3" data-path="nonparametrics.html"><a href="nonparametrics.html#sign-test"><i class="fa fa-check"></i><b>19.3</b> Sign Test</a><ul>
<li class="chapter" data-level="19.3.1" data-path="nonparametrics.html"><a href="nonparametrics.html#interpretation-1"><i class="fa fa-check"></i><b>19.3.1</b> Interpretation</a></li>
<li class="chapter" data-level="19.3.2" data-path="nonparametrics.html"><a href="nonparametrics.html#write-up-5"><i class="fa fa-check"></i><b>19.3.2</b> Write Up</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="nonparametrics.html"><a href="nonparametrics.html#wilcoxon-sign-rank-test-for-one-group"><i class="fa fa-check"></i><b>19.4</b> Wilcoxon Sign Rank Test for One Group</a><ul>
<li class="chapter" data-level="19.4.1" data-path="nonparametrics.html"><a href="nonparametrics.html#wilcoxon-sign-rank-experimental-designs"><i class="fa fa-check"></i><b>19.4.1</b> Wilcoxon Sign Rank Experimental Designs</a></li>
<li class="chapter" data-level="19.4.2" data-path="nonparametrics.html"><a href="nonparametrics.html#interpretation-2"><i class="fa fa-check"></i><b>19.4.2</b> Interpretation</a></li>
<li class="chapter" data-level="19.4.3" data-path="nonparametrics.html"><a href="nonparametrics.html#write-up-6"><i class="fa fa-check"></i><b>19.4.3</b> Write Up</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="nonparametrics.html"><a href="nonparametrics.html#wilcoxon-mann-whitney-rank-sum-test-for-2-independent-groups"><i class="fa fa-check"></i><b>19.5</b> Wilcoxon Mann Whitney Rank Sum Test for 2 independent groups</a><ul>
<li class="chapter" data-level="19.5.1" data-path="nonparametrics.html"><a href="nonparametrics.html#interpretation-3"><i class="fa fa-check"></i><b>19.5.1</b> Interpretation</a></li>
<li class="chapter" data-level="19.5.2" data-path="nonparametrics.html"><a href="nonparametrics.html#write-up-7"><i class="fa fa-check"></i><b>19.5.2</b> Write Up</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="nonparametrics.html"><a href="nonparametrics.html#wilcoxon-sign-rank-test-for-paired-groups"><i class="fa fa-check"></i><b>19.6</b> Wilcoxon Sign Rank Test for paired groups</a><ul>
<li class="chapter" data-level="19.6.1" data-path="nonparametrics.html"><a href="nonparametrics.html#interpretation-4"><i class="fa fa-check"></i><b>19.6.1</b> Interpretation</a></li>
<li class="chapter" data-level="19.6.2" data-path="nonparametrics.html"><a href="nonparametrics.html#write-up-8"><i class="fa fa-check"></i><b>19.6.2</b> Write up</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="nonparametrics.html"><a href="nonparametrics.html#kruskal-wallis"><i class="fa fa-check"></i><b>19.7</b> Kruskal-Wallis</a><ul>
<li class="chapter" data-level="19.7.1" data-path="nonparametrics.html"><a href="nonparametrics.html#write-up-9"><i class="fa fa-check"></i><b>19.7.1</b> Write Up</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="nonparametrics.html"><a href="nonparametrics.html#friedman-test"><i class="fa fa-check"></i><b>19.8</b> Friedman test</a></li>
<li class="chapter" data-level="19.9" data-path="nonparametrics.html"><a href="nonparametrics.html#nonparametric-power-calculations"><i class="fa fa-check"></i><b>19.9</b> Nonparametric power calculations</a><ul>
<li class="chapter" data-level="19.9.1" data-path="nonparametrics.html"><a href="nonparametrics.html#how-it-works"><i class="fa fa-check"></i><b>19.9.1</b> How it works</a></li>
<li class="chapter" data-level="19.9.2" data-path="nonparametrics.html"><a href="nonparametrics.html#initialization-with-population-parameters"><i class="fa fa-check"></i><b>19.9.2</b> Initialization with population parameters</a></li>
<li class="chapter" data-level="19.9.3" data-path="nonparametrics.html"><a href="nonparametrics.html#an-example"><i class="fa fa-check"></i><b>19.9.3</b> An example</a></li>
<li class="chapter" data-level="19.9.4" data-path="nonparametrics.html"><a href="nonparametrics.html#nonpara.pwr"><i class="fa fa-check"></i><b>19.9.4</b> nonpara.pwr</a></li>
</ul></li>
<li class="chapter" data-level="19.10" data-path="nonparametrics.html"><a href="nonparametrics.html#summary-1"><i class="fa fa-check"></i><b>19.10</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="signrank.html"><a href="signrank.html"><i class="fa fa-check"></i><b>20</b> Signed Rank Distribution</a><ul>
<li class="chapter" data-level="20.1" data-path="signrank.html"><a href="signrank.html#transformation-of-data-into-sign-ranks"><i class="fa fa-check"></i><b>20.1</b> Transformation of data into sign ranks</a><ul>
<li class="chapter" data-level="20.1.1" data-path="signrank.html"><a href="signrank.html#for-a-one-group-sample"><i class="fa fa-check"></i><b>20.1.1</b> For a one group sample</a></li>
<li class="chapter" data-level="20.1.2" data-path="signrank.html"><a href="signrank.html#for-a-paired-sample"><i class="fa fa-check"></i><b>20.1.2</b> For a paired sample</a></li>
<li class="chapter" data-level="20.1.3" data-path="signrank.html"><a href="signrank.html#the-sign-rank-test-statistic-in-r"><i class="fa fa-check"></i><b>20.1.3</b> The sign rank test statistic in R</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="signrank.html"><a href="signrank.html#rs-four-sign-rank-distribution-functions"><i class="fa fa-check"></i><b>20.2</b> R’s Four Sign Rank Distribution Functions</a><ul>
<li class="chapter" data-level="20.2.1" data-path="signrank.html"><a href="signrank.html#dsignrank"><i class="fa fa-check"></i><b>20.2.1</b> dsignrank</a></li>
<li class="chapter" data-level="20.2.2" data-path="signrank.html"><a href="signrank.html#psignrank"><i class="fa fa-check"></i><b>20.2.2</b> psignrank</a></li>
<li class="chapter" data-level="20.2.3" data-path="signrank.html"><a href="signrank.html#qsignrank"><i class="fa fa-check"></i><b>20.2.3</b> qsignrank</a></li>
<li class="chapter" data-level="20.2.4" data-path="signrank.html"><a href="signrank.html#rsignrank"><i class="fa fa-check"></i><b>20.2.4</b> rsignrank</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="ranksum.html"><a href="ranksum.html"><i class="fa fa-check"></i><b>21</b> Rank Sum Distribution</a><ul>
<li class="chapter" data-level="21.0.1" data-path="ranksum.html"><a href="ranksum.html#transformation-of-data-into-rank-summs"><i class="fa fa-check"></i><b>21.0.1</b> Transformation of data into rank summs</a></li>
<li class="chapter" data-level="21.0.2" data-path="ranksum.html"><a href="ranksum.html#the-sign-rank-test-statistic-in-r-1"><i class="fa fa-check"></i><b>21.0.2</b> The sign rank test statistic in R</a></li>
<li class="chapter" data-level="21.1" data-path="ranksum.html"><a href="ranksum.html#rs-four-sign-rank-distribution-functions-1"><i class="fa fa-check"></i><b>21.1</b> R’s Four Sign Rank Distribution Functions</a><ul>
<li class="chapter" data-level="21.1.1" data-path="ranksum.html"><a href="ranksum.html#dwilcox"><i class="fa fa-check"></i><b>21.1.1</b> dwilcox</a></li>
<li class="chapter" data-level="21.1.2" data-path="ranksum.html"><a href="ranksum.html#pwilcox"><i class="fa fa-check"></i><b>21.1.2</b> pwilcox</a></li>
<li class="chapter" data-level="21.1.3" data-path="ranksum.html"><a href="ranksum.html#qwilcox"><i class="fa fa-check"></i><b>21.1.3</b> qwilcox</a></li>
<li class="chapter" data-level="21.1.4" data-path="ranksum.html"><a href="ranksum.html#rwilcox"><i class="fa fa-check"></i><b>21.1.4</b> rwilcox</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="ttests.html"><a href="ttests.html"><i class="fa fa-check"></i><b>22</b> The t-tests</a><ul>
<li class="chapter" data-level="22.1" data-path="ttests.html"><a href="ttests.html#data-assumptions-for-t-tests"><i class="fa fa-check"></i><b>22.1</b> Data assumptions for t-tests</a></li>
<li class="chapter" data-level="22.2" data-path="ttests.html"><a href="ttests.html#the-t-statistic"><i class="fa fa-check"></i><b>22.2</b> The t Statistic</a><ul>
<li class="chapter" data-level="22.2.1" data-path="ttests.html"><a href="ttests.html#one-sample-t-tests"><i class="fa fa-check"></i><b>22.2.1</b> One sample t tests</a></li>
<li class="chapter" data-level="22.2.2" data-path="ttests.html"><a href="ttests.html#unpaired-t-tests"><i class="fa fa-check"></i><b>22.2.2</b> Unpaired t tests</a></li>
<li class="chapter" data-level="22.2.3" data-path="ttests.html"><a href="ttests.html#paired-t-tests"><i class="fa fa-check"></i><b>22.2.3</b> Paired t tests</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="ttests.html"><a href="ttests.html#t-test-hypotheses"><i class="fa fa-check"></i><b>22.3</b> t Test Hypotheses</a><ul>
<li class="chapter" data-level="22.3.1" data-path="ttests.html"><a href="ttests.html#one-sample-hypotheses"><i class="fa fa-check"></i><b>22.3.1</b> One sample hypotheses</a></li>
<li class="chapter" data-level="22.3.2" data-path="ttests.html"><a href="ttests.html#unpaired-hypotheses"><i class="fa fa-check"></i><b>22.3.2</b> Unpaired hypotheses</a></li>
<li class="chapter" data-level="22.3.3" data-path="ttests.html"><a href="ttests.html#paired-hypotheses"><i class="fa fa-check"></i><b>22.3.3</b> Paired hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="ttests.html"><a href="ttests.html#confidence-intervals-of-means"><i class="fa fa-check"></i><b>22.4</b> Confidence Intervals of Means</a></li>
<li class="chapter" data-level="22.5" data-path="ttests.html"><a href="ttests.html#t-tests-running-the-analysis"><i class="fa fa-check"></i><b>22.5</b> t Tests: Running the analysis</a><ul>
<li class="chapter" data-level="22.5.1" data-path="ttests.html"><a href="ttests.html#one-sample-t-test"><i class="fa fa-check"></i><b>22.5.1</b> One sample t test</a></li>
<li class="chapter" data-level="22.5.2" data-path="ttests.html"><a href="ttests.html#unpaired-t-test"><i class="fa fa-check"></i><b>22.5.2</b> Unpaired t test</a></li>
<li class="chapter" data-level="22.5.3" data-path="ttests.html"><a href="ttests.html#paired-t-test"><i class="fa fa-check"></i><b>22.5.3</b> Paired t Test</a></li>
</ul></li>
<li class="chapter" data-level="22.6" data-path="ttests.html"><a href="ttests.html#plotting-t-tests"><i class="fa fa-check"></i><b>22.6</b> Plotting t Tests</a><ul>
<li class="chapter" data-level="22.6.1" data-path="ttests.html"><a href="ttests.html#unpaired"><i class="fa fa-check"></i><b>22.6.1</b> Unpaired</a></li>
<li class="chapter" data-level="22.6.2" data-path="ttests.html"><a href="ttests.html#paired"><i class="fa fa-check"></i><b>22.6.2</b> Paired</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="ttests.html"><a href="ttests.html#t-test-power"><i class="fa fa-check"></i><b>22.7</b> t Test Power</a><ul>
<li class="chapter" data-level="22.7.1" data-path="ttests.html"><a href="ttests.html#interpretation-7"><i class="fa fa-check"></i><b>22.7.1</b> Interpretation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ttestmc.html"><a href="ttestmc.html"><i class="fa fa-check"></i><b>23</b> Statistical design of t-tests</a><ul>
<li class="chapter" data-level="23.1" data-path="ttestmc.html"><a href="ttestmc.html#about-this-chapter"><i class="fa fa-check"></i><b>23.1</b> About this chapter</a><ul>
<li class="chapter" data-level="23.1.1" data-path="ttestmc.html"><a href="ttestmc.html#overview"><i class="fa fa-check"></i><b>23.1.1</b> Overview</a></li>
<li class="chapter" data-level="23.1.2" data-path="ttestmc.html"><a href="ttestmc.html#simulating-data"><i class="fa fa-check"></i><b>23.1.2</b> Simulating data</a></li>
<li class="chapter" data-level="23.1.3" data-path="ttestmc.html"><a href="ttestmc.html#change-n-to-zero-in-on-the-power-you-want"><i class="fa fa-check"></i><b>23.1.3</b> Change n to zero in on the power you want</a></li>
<li class="chapter" data-level="23.1.4" data-path="ttestmc.html"><a href="ttestmc.html#scenario"><i class="fa fa-check"></i><b>23.1.4</b> Scenario</a></li>
<li class="chapter" data-level="23.1.5" data-path="ttestmc.html"><a href="ttestmc.html#what-would-be-a-scientifically-meaningful-response"><i class="fa fa-check"></i><b>23.1.5</b> What would be a scientifically meaningful response?</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="ttestmc.html"><a href="ttestmc.html#one-sample-t-test-monte-carlo"><i class="fa fa-check"></i><b>23.2</b> One sample t-test Monte Carlo</a></li>
<li class="chapter" data-level="23.3" data-path="ttestmc.html"><a href="ttestmc.html#unpaired-t-test-monte-carlo"><i class="fa fa-check"></i><b>23.3</b> Unpaired t-test Monte Carlo</a></li>
<li class="chapter" data-level="23.4" data-path="ttestmc.html"><a href="ttestmc.html#paired-t-test-monte-carlo"><i class="fa fa-check"></i><b>23.4</b> Paired t-test Monte Carlo</a></li>
<li class="chapter" data-level="23.5" data-path="ttestmc.html"><a href="ttestmc.html#dt"><i class="fa fa-check"></i><b>23.5</b> dt</a></li>
<li class="chapter" data-level="23.6" data-path="ttestmc.html"><a href="ttestmc.html#pt"><i class="fa fa-check"></i><b>23.6</b> pt</a></li>
<li class="chapter" data-level="23.7" data-path="ttestmc.html"><a href="ttestmc.html#qt"><i class="fa fa-check"></i><b>23.7</b> qt</a></li>
<li class="chapter" data-level="23.8" data-path="ttestmc.html"><a href="ttestmc.html#rt"><i class="fa fa-check"></i><b>23.8</b> rt</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="simcorrelation.html"><a href="simcorrelation.html"><i class="fa fa-check"></i><b>24</b> Simulating correlated variables</a><ul>
<li class="chapter" data-level="24.1" data-path="simcorrelation.html"><a href="simcorrelation.html#estimating-correlation-between-two-variables"><i class="fa fa-check"></i><b>24.1</b> Estimating correlation between two variables</a></li>
<li class="chapter" data-level="24.2" data-path="simcorrelation.html"><a href="simcorrelation.html#simulating-correlated-variables"><i class="fa fa-check"></i><b>24.2</b> Simulating correlated variables</a></li>
<li class="chapter" data-level="24.3" data-path="simcorrelation.html"><a href="simcorrelation.html#monte-carlo-simulation"><i class="fa fa-check"></i><b>24.3</b> Monte Carlo simulation</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="introanova.html"><a href="introanova.html"><i class="fa fa-check"></i><b>25</b> Introduction to ANOVA</a><ul>
<li class="chapter" data-level="25.1" data-path="introanova.html"><a href="introanova.html#factors-and-levels"><i class="fa fa-check"></i><b>25.1</b> Factors and levels</a></li>
<li class="chapter" data-level="25.2" data-path="introanova.html"><a href="introanova.html#anova-models-one--two--and-three-way"><i class="fa fa-check"></i><b>25.2</b> ANOVA models: One-, Two-, and Three-way</a></li>
<li class="chapter" data-level="25.3" data-path="introanova.html"><a href="introanova.html#anova-inference-protocol"><i class="fa fa-check"></i><b>25.3</b> ANOVA inference protocol</a></li>
<li class="chapter" data-level="25.4" data-path="introanova.html"><a href="introanova.html#anova-calculations"><i class="fa fa-check"></i><b>25.4</b> ANOVA calculations</a><ul>
<li class="chapter" data-level="25.4.1" data-path="introanova.html"><a href="introanova.html#sums-of-squares-partitioning"><i class="fa fa-check"></i><b>25.4.1</b> Sums of Squares partitioning</a></li>
<li class="chapter" data-level="25.4.2" data-path="introanova.html"><a href="introanova.html#degrees-of-freedom"><i class="fa fa-check"></i><b>25.4.2</b> Degrees of freedom</a></li>
<li class="chapter" data-level="25.4.3" data-path="introanova.html"><a href="introanova.html#the-mean-squares"><i class="fa fa-check"></i><b>25.4.3</b> The mean squares</a></li>
<li class="chapter" data-level="25.4.4" data-path="introanova.html"><a href="introanova.html#the-anova-table"><i class="fa fa-check"></i><b>25.4.4</b> The ANOVA table</a></li>
<li class="chapter" data-level="25.4.5" data-path="introanova.html"><a href="introanova.html#the-f-test"><i class="fa fa-check"></i><b>25.4.5</b> The F-test</a></li>
<li class="chapter" data-level="25.4.6" data-path="introanova.html"><a href="introanova.html#post-hoc-group-comparisons"><i class="fa fa-check"></i><b>25.4.6</b> Post-hoc group comparisons</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="introanova.html"><a href="introanova.html#completely-randomized-or-related-measures"><i class="fa fa-check"></i><b>25.5</b> Completely randomized or related measures</a><ul>
<li class="chapter" data-level="25.5.1" data-path="introanova.html"><a href="introanova.html#the-problem-of-lost-data-in-related-measures-designs"><i class="fa fa-check"></i><b>25.5.1</b> The problem of lost data in related measures designs</a></li>
</ul></li>
<li class="chapter" data-level="25.6" data-path="introanova.html"><a href="introanova.html#two-way-anova"><i class="fa fa-check"></i><b>25.6</b> Two-way ANOVA</a></li>
<li class="chapter" data-level="25.7" data-path="introanova.html"><a href="introanova.html#other-anova-models"><i class="fa fa-check"></i><b>25.7</b> Other ANOVA models</a><ul>
<li class="chapter" data-level="25.7.1" data-path="introanova.html"><a href="introanova.html#r-and-anova"><i class="fa fa-check"></i><b>25.7.1</b> R and ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="25.8" data-path="introanova.html"><a href="introanova.html#alternatives-to-anova"><i class="fa fa-check"></i><b>25.8</b> Alternatives to ANOVA</a><ul>
<li class="chapter" data-level="25.8.1" data-path="introanova.html"><a href="introanova.html#screw-anova-just-tell-me-how-to-t-test-everything"><i class="fa fa-check"></i><b>25.8.1</b> Screw ANOVA, Just Tell Me How to t-Test Everything</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="fdistr.html"><a href="fdistr.html"><i class="fa fa-check"></i><b>26</b> The F distribution</a><ul>
<li class="chapter" data-level="26.1" data-path="fdistr.html"><a href="fdistr.html#background-1"><i class="fa fa-check"></i><b>26.1</b> Background</a><ul>
<li class="chapter" data-level="26.1.1" data-path="fdistr.html"><a href="fdistr.html#sample-variance-and-fs-pdf"><i class="fa fa-check"></i><b>26.1.1</b> Sample Variance and F’s PDF</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="fdistr.html"><a href="fdistr.html#df"><i class="fa fa-check"></i><b>26.2</b> df</a></li>
<li class="chapter" data-level="26.3" data-path="fdistr.html"><a href="fdistr.html#pf"><i class="fa fa-check"></i><b>26.3</b> pf</a></li>
<li class="chapter" data-level="26.4" data-path="fdistr.html"><a href="fdistr.html#qf"><i class="fa fa-check"></i><b>26.4</b> qf</a></li>
<li class="chapter" data-level="26.5" data-path="fdistr.html"><a href="fdistr.html#rf"><i class="fa fa-check"></i><b>26.5</b> rf</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="onewayanova.html"><a href="onewayanova.html"><i class="fa fa-check"></i><b>27</b> One-way ANOVA Completely Randomized</a><ul>
<li class="chapter" data-level="27.1" data-path="onewayanova.html"><a href="onewayanova.html#using-ezanova"><i class="fa fa-check"></i><b>27.1</b> Using <code>ezANOVA</code></a></li>
<li class="chapter" data-level="27.2" data-path="onewayanova.html"><a href="onewayanova.html#the-chickwt-data-set"><i class="fa fa-check"></i><b>27.2</b> The chickwt data set</a><ul>
<li class="chapter" data-level="27.2.1" data-path="onewayanova.html"><a href="onewayanova.html#inspect-the-data"><i class="fa fa-check"></i><b>27.2.1</b> Inspect the data</a></li>
</ul></li>
<li class="chapter" data-level="27.3" data-path="onewayanova.html"><a href="onewayanova.html#run-the-anova"><i class="fa fa-check"></i><b>27.3</b> Run the ANOVA</a><ul>
<li class="chapter" data-level="27.3.1" data-path="onewayanova.html"><a href="onewayanova.html#run-the-chickwts-one-way-anova"><i class="fa fa-check"></i><b>27.3.1</b> Run the chickwts One Way ANOVA</a></li>
<li class="chapter" data-level="27.3.2" data-path="onewayanova.html"><a href="onewayanova.html#interpreting-the-one-way-cr-anova-output"><i class="fa fa-check"></i><b>27.3.2</b> Interpreting the One-Way CR ANOVA Output</a></li>
</ul></li>
<li class="chapter" data-level="27.4" data-path="onewayanova.html"><a href="onewayanova.html#posthoc"><i class="fa fa-check"></i><b>27.4</b> Post hoc pairwise comparisons</a><ul>
<li class="chapter" data-level="27.4.1" data-path="onewayanova.html"><a href="onewayanova.html#overview-of-options"><i class="fa fa-check"></i><b>27.4.1</b> Overview of options</a></li>
</ul></li>
<li class="chapter" data-level="27.5" data-path="onewayanova.html"><a href="onewayanova.html#reporting-the-result"><i class="fa fa-check"></i><b>27.5</b> Reporting the result</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="onewayRM.html"><a href="onewayRM.html"><i class="fa fa-check"></i><b>28</b> One-way ANOVA Related Measures</a><ul>
<li class="chapter" data-level="28.1" data-path="onewayRM.html"><a href="onewayRM.html#data-prep"><i class="fa fa-check"></i><b>28.1</b> Data prep</a></li>
<li class="chapter" data-level="28.2" data-path="onewayRM.html"><a href="onewayRM.html#run-the-anova-1"><i class="fa fa-check"></i><b>28.2</b> Run the ANOVA</a></li>
<li class="chapter" data-level="28.3" data-path="onewayRM.html"><a href="onewayRM.html#interpretation-8"><i class="fa fa-check"></i><b>28.3</b> Interpretation</a></li>
<li class="chapter" data-level="28.4" data-path="onewayRM.html"><a href="onewayRM.html#post-hoc-analysis"><i class="fa fa-check"></i><b>28.4</b> Post-hoc analysis</a></li>
<li class="chapter" data-level="28.5" data-path="onewayRM.html"><a href="onewayRM.html#write-up-10"><i class="fa fa-check"></i><b>28.5</b> Write up</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="twowayCR.html"><a href="twowayCR.html"><i class="fa fa-check"></i><b>29</b> Two-way ANOVA Completely Randomized</a><ul>
<li class="chapter" data-level="29.1" data-path="twowayCR.html"><a href="twowayCR.html#effect-of-strain-and-diet-on-liver"><i class="fa fa-check"></i><b>29.1</b> Effect of Strain and Diet on Liver</a></li>
<li class="chapter" data-level="29.2" data-path="twowayCR.html"><a href="twowayCR.html#the-test"><i class="fa fa-check"></i><b>29.2</b> The test</a></li>
<li class="chapter" data-level="29.3" data-path="twowayCR.html"><a href="twowayCR.html#interpretation-of-2-way-cr-anova-output"><i class="fa fa-check"></i><b>29.3</b> Interpretation of 2 Way CR ANOVA Output</a><ul>
<li class="chapter" data-level="29.3.1" data-path="twowayCR.html"><a href="twowayCR.html#levenes"><i class="fa fa-check"></i><b>29.3.1</b> Levene’s</a></li>
<li class="chapter" data-level="29.3.2" data-path="twowayCR.html"><a href="twowayCR.html#anova-table"><i class="fa fa-check"></i><b>29.3.2</b> ANOVA Table</a></li>
</ul></li>
<li class="chapter" data-level="29.4" data-path="twowayCR.html"><a href="twowayCR.html#post-hoc-multiple-comparisons"><i class="fa fa-check"></i><b>29.4</b> Post Hoc Multiple Comparisons</a><ul>
<li class="chapter" data-level="29.4.1" data-path="twowayCR.html"><a href="twowayCR.html#write-up-11"><i class="fa fa-check"></i><b>29.4.1</b> Write Up</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="30" data-path="twowayRM.html"><a href="twowayRM.html"><i class="fa fa-check"></i><b>30</b> Two-way ANOVA Related Measures</a><ul>
<li class="chapter" data-level="30.1" data-path="twowayRM.html"><a href="twowayRM.html#cell-culture"><i class="fa fa-check"></i><b>30.1</b> Cell culture</a></li>
<li class="chapter" data-level="30.2" data-path="twowayRM.html"><a href="twowayRM.html#the-test-1"><i class="fa fa-check"></i><b>30.2</b> The test</a></li>
<li class="chapter" data-level="30.3" data-path="twowayRM.html"><a href="twowayRM.html#interpretation-of-the-output"><i class="fa fa-check"></i><b>30.3</b> Interpretation of the output</a><ul>
<li class="chapter" data-level="30.3.1" data-path="twowayRM.html"><a href="twowayRM.html#anova-table-1"><i class="fa fa-check"></i><b>30.3.1</b> ANOVA Table</a></li>
<li class="chapter" data-level="30.3.2" data-path="twowayRM.html"><a href="twowayRM.html#mauchlys-sphericity-test"><i class="fa fa-check"></i><b>30.3.2</b> Mauchly’s Sphericity Test</a></li>
</ul></li>
<li class="chapter" data-level="30.4" data-path="twowayRM.html"><a href="twowayRM.html#post-hoc-multiple-comparisons-1"><i class="fa fa-check"></i><b>30.4</b> Post Hoc multiple comparisons</a></li>
<li class="chapter" data-level="30.5" data-path="twowayRM.html"><a href="twowayRM.html#write-up-12"><i class="fa fa-check"></i><b>30.5</b> Write Up</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="twowaymixed.html"><a href="twowaymixed.html"><i class="fa fa-check"></i><b>31</b> Two-way ANOVA RM/CR</a><ul>
<li class="chapter" data-level="31.1" data-path="twowaymixed.html"><a href="twowaymixed.html#chickweight-dataset"><i class="fa fa-check"></i><b>31.1</b> ChickWeight Dataset</a></li>
<li class="chapter" data-level="31.2" data-path="twowaymixed.html"><a href="twowaymixed.html#munge-chickweight-data"><i class="fa fa-check"></i><b>31.2</b> Munge ChickWeight data</a></li>
<li class="chapter" data-level="31.3" data-path="twowaymixed.html"><a href="twowaymixed.html#the-test-2"><i class="fa fa-check"></i><b>31.3</b> The test</a></li>
<li class="chapter" data-level="31.4" data-path="twowaymixed.html"><a href="twowaymixed.html#interpreting-the-anova-output"><i class="fa fa-check"></i><b>31.4</b> Interpreting the ANOVA output</a><ul>
<li class="chapter" data-level="31.4.1" data-path="twowaymixed.html"><a href="twowaymixed.html#anova-the-anova-table-1"><i class="fa fa-check"></i><b>31.4.1</b> $ANOVA: The ANOVA table</a></li>
<li class="chapter" data-level="31.4.2" data-path="twowaymixed.html"><a href="twowaymixed.html#mauchlys-test-and-corrections"><i class="fa fa-check"></i><b>31.4.2</b> Mauchly’s Test and Corrections</a></li>
</ul></li>
<li class="chapter" data-level="31.5" data-path="twowaymixed.html"><a href="twowaymixed.html#post-hoc-pairwise-tests"><i class="fa fa-check"></i><b>31.5</b> Post hoc pairwise tests</a><ul>
<li class="chapter" data-level="31.5.1" data-path="twowaymixed.html"><a href="twowaymixed.html#heres-whats-been-discovered"><i class="fa fa-check"></i><b>31.5.1</b> Here’s what’s been discovered</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="32" data-path="jaxwest2.html"><a href="jaxwest2.html"><i class="fa fa-check"></i><b>32</b> Reproducible Data Munging Mostly with Tidyverse</a><ul>
<li class="chapter" data-level="32.1" data-path="jaxwest2.html"><a href="jaxwest2.html#look-at-the-original-data-carefully"><i class="fa fa-check"></i><b>32.1</b> Look at the original data carefully</a></li>
<li class="chapter" data-level="32.2" data-path="jaxwest2.html"><a href="jaxwest2.html#our-goal"><i class="fa fa-check"></i><b>32.2</b> Our goal</a></li>
<li class="chapter" data-level="32.3" data-path="jaxwest2.html"><a href="jaxwest2.html#read-the-data-into-r"><i class="fa fa-check"></i><b>32.3</b> Read the data into R</a></li>
<li class="chapter" data-level="32.4" data-path="jaxwest2.html"><a href="jaxwest2.html#select-the-variables"><i class="fa fa-check"></i><b>32.4</b> Select the variables</a></li>
<li class="chapter" data-level="32.5" data-path="jaxwest2.html"><a href="jaxwest2.html#trim-the-cases"><i class="fa fa-check"></i><b>32.5</b> Trim the cases</a></li>
<li class="chapter" data-level="32.6" data-path="jaxwest2.html"><a href="jaxwest2.html#go-long"><i class="fa fa-check"></i><b>32.6</b> Go long</a></li>
<li class="chapter" data-level="32.7" data-path="jaxwest2.html"><a href="jaxwest2.html#pull-out-the-values-for-the-day-variable"><i class="fa fa-check"></i><b>32.7</b> Pull out the values for the day variable</a></li>
<li class="chapter" data-level="32.8" data-path="jaxwest2.html"><a href="jaxwest2.html#convert-day-to-numeric"><i class="fa fa-check"></i><b>32.8</b> Convert day to numeric</a></li>
<li class="chapter" data-level="32.9" data-path="jaxwest2.html"><a href="jaxwest2.html#convert-tumor_vol-to-numeric"><i class="fa fa-check"></i><b>32.9</b> Convert tumor_vol to numeric</a></li>
<li class="chapter" data-level="32.10" data-path="jaxwest2.html"><a href="jaxwest2.html#deal-with-that-na"><i class="fa fa-check"></i><b>32.10</b> Deal with that NA</a></li>
<li class="chapter" data-level="32.11" data-path="jaxwest2.html"><a href="jaxwest2.html#convert-variables-to-factor"><i class="fa fa-check"></i><b>32.11</b> Convert variables to factor</a></li>
<li class="chapter" data-level="32.12" data-path="jaxwest2.html"><a href="jaxwest2.html#plot-the-data"><i class="fa fa-check"></i><b>32.12</b> Plot the data</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="anovamc.html"><a href="anovamc.html"><i class="fa fa-check"></i><b>33</b> ANOVA power using Monte Carlo</a><ul>
<li class="chapter" data-level="33.1" data-path="anovamc.html"><a href="anovamc.html#alternatives-to-monte-carlo"><i class="fa fa-check"></i><b>33.1</b> Alternatives to Monte Carlo</a></li>
<li class="chapter" data-level="33.2" data-path="anovamc.html"><a href="anovamc.html#what-is-monte-carlo"><i class="fa fa-check"></i><b>33.2</b> What is Monte Carlo</a></li>
<li class="chapter" data-level="33.3" data-path="anovamc.html"><a href="anovamc.html#one-way-completely-randomized-anova-monte-carlo"><i class="fa fa-check"></i><b>33.3</b> One-way completely randomized ANOVA Monte Carlo</a><ul>
<li class="chapter" data-level="33.3.1" data-path="anovamc.html"><a href="anovamc.html#directions"><i class="fa fa-check"></i><b>33.3.1</b> Directions</a></li>
<li class="chapter" data-level="33.3.2" data-path="anovamc.html"><a href="anovamc.html#step-1-create-initial-values"><i class="fa fa-check"></i><b>33.3.2</b> Step 1: Create initial values</a></li>
<li class="chapter" data-level="33.3.3" data-path="anovamc.html"><a href="anovamc.html#step-2-visualize-one-random-sample"><i class="fa fa-check"></i><b>33.3.3</b> Step 2: Visualize one random sample</a></li>
<li class="chapter" data-level="33.3.4" data-path="anovamc.html"><a href="anovamc.html#step-3-run-the-power-simulator"><i class="fa fa-check"></i><b>33.3.4</b> Step 3: Run The Power Simulator</a></li>
<li class="chapter" data-level="33.3.5" data-path="anovamc.html"><a href="anovamc.html#step-4-optimize-for-suitable-power"><i class="fa fa-check"></i><b>33.3.5</b> Step 4: Optimize for suitable power</a></li>
<li class="chapter" data-level="33.3.6" data-path="anovamc.html"><a href="anovamc.html#notes-and-considerations"><i class="fa fa-check"></i><b>33.3.6</b> Notes And Considerations</a></li>
</ul></li>
<li class="chapter" data-level="33.4" data-path="anovamc.html"><a href="anovamc.html#one-way-related-measures-anova-monte-carlo"><i class="fa fa-check"></i><b>33.4</b> One-way related measures ANOVA Monte Carlo</a></li>
<li class="chapter" data-level="33.5" data-path="anovamc.html"><a href="anovamc.html#directions-1"><i class="fa fa-check"></i><b>33.5</b> Directions</a><ul>
<li class="chapter" data-level="33.5.1" data-path="anovamc.html"><a href="anovamc.html#step-1-initial-values"><i class="fa fa-check"></i><b>33.5.1</b> Step 1: Initial values</a></li>
<li class="chapter" data-level="33.5.2" data-path="anovamc.html"><a href="anovamc.html#step-2-visualize-one-sample"><i class="fa fa-check"></i><b>33.5.2</b> Step 2: Visualize one sample</a></li>
<li class="chapter" data-level="33.5.3" data-path="anovamc.html"><a href="anovamc.html#step-3-run-the-power-simulator-1"><i class="fa fa-check"></i><b>33.5.3</b> Step 3: Run the power simulator</a></li>
<li class="chapter" data-level="33.5.4" data-path="anovamc.html"><a href="anovamc.html#step-4-should-anything-be-changed"><i class="fa fa-check"></i><b>33.5.4</b> Step 4: Should anything be changed?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="34" data-path="correl.html"><a href="correl.html"><i class="fa fa-check"></i><b>34</b> Correlation</a><ul>
<li class="chapter" data-level="34.1" data-path="correl.html"><a href="correl.html#correlation-causation"><i class="fa fa-check"></i><b>34.1</b> Correlation != Causation</a></li>
<li class="chapter" data-level="34.2" data-path="correl.html"><a href="correl.html#correlation-in-multivariate-outcomes-and-paired-designs"><i class="fa fa-check"></i><b>34.2</b> Correlation in Multivariate Outcomes and Paired Designs</a></li>
<li class="chapter" data-level="34.3" data-path="correl.html"><a href="correl.html#correlation-coefficients"><i class="fa fa-check"></i><b>34.3</b> Correlation coefficients</a><ul>
<li class="chapter" data-level="34.3.1" data-path="correl.html"><a href="correl.html#pearsons-correlation-coefficient"><i class="fa fa-check"></i><b>34.3.1</b> Pearson’s correlation coefficient</a></li>
<li class="chapter" data-level="34.3.2" data-path="correl.html"><a href="correl.html#spearmans-rank-correlation"><i class="fa fa-check"></i><b>34.3.2</b> Spearman’s rank correlation</a></li>
<li class="chapter" data-level="34.3.3" data-path="correl.html"><a href="correl.html#kendalls-tau"><i class="fa fa-check"></i><b>34.3.3</b> Kendall’s tau</a></li>
<li class="chapter" data-level="34.3.4" data-path="correl.html"><a href="correl.html#which-correlation-method-to-use"><i class="fa fa-check"></i><b>34.3.4</b> Which correlation method to use?</a></li>
<li class="chapter" data-level="34.3.5" data-path="correl.html"><a href="correl.html#r-correlation-analysis-functions"><i class="fa fa-check"></i><b>34.3.5</b> R correlation analysis functions</a></li>
<li class="chapter" data-level="34.3.6" data-path="correl.html"><a href="correl.html#plot-the-correlations"><i class="fa fa-check"></i><b>34.3.6</b> Plot the correlations</a></li>
<li class="chapter" data-level="34.3.7" data-path="correl.html"><a href="correl.html#calculate-a-correlation-coefficient-and-posthoc-test"><i class="fa fa-check"></i><b>34.3.7</b> Calculate a correlation coefficient and posthoc test</a></li>
<li class="chapter" data-level="34.3.8" data-path="correl.html"><a href="correl.html#interpretation-of-correlation-output"><i class="fa fa-check"></i><b>34.3.8</b> Interpretation of correlation output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="35" data-path="regress.html"><a href="regress.html"><i class="fa fa-check"></i><b>35</b> Linear Regression</a><ul>
<li class="chapter" data-level="35.1" data-path="regress.html"><a href="regress.html#the-linear-regression-model"><i class="fa fa-check"></i><b>35.1</b> The linear regression model</a></li>
<li class="chapter" data-level="35.2" data-path="regress.html"><a href="regress.html#least-squares-fitting"><i class="fa fa-check"></i><b>35.2</b> Least squares fitting</a></li>
<li class="chapter" data-level="35.3" data-path="regress.html"><a href="regress.html#the-practical-importance-of-linear-model-parameters"><i class="fa fa-check"></i><b>35.3</b> The practical importance of linear model parameters</a></li>
<li class="chapter" data-level="35.4" data-path="regress.html"><a href="regress.html#linear-model-standard-errors"><i class="fa fa-check"></i><b>35.4</b> Linear model standard errors</a></li>
<li class="chapter" data-level="35.5" data-path="regress.html"><a href="regress.html#linear-regression-in-r"><i class="fa fa-check"></i><b>35.5</b> Linear regression in R</a></li>
<li class="chapter" data-level="35.6" data-path="regress.html"><a href="regress.html#intepretation-1"><i class="fa fa-check"></i><b>35.6</b> Intepretation</a><ul>
<li class="chapter" data-level="35.6.1" data-path="regress.html"><a href="regress.html#residuals"><i class="fa fa-check"></i><b>35.6.1</b> Residuals</a></li>
<li class="chapter" data-level="35.6.2" data-path="regress.html"><a href="regress.html#coefficients"><i class="fa fa-check"></i><b>35.6.2</b> Coefficients</a></li>
<li class="chapter" data-level="35.6.3" data-path="regress.html"><a href="regress.html#degrees-of-freedom-1"><i class="fa fa-check"></i><b>35.6.3</b> Degrees of freedom</a></li>
<li class="chapter" data-level="35.6.4" data-path="regress.html"><a href="regress.html#r-squared"><i class="fa fa-check"></i><b>35.6.4</b> R-squared</a></li>
<li class="chapter" data-level="35.6.5" data-path="regress.html"><a href="regress.html#f-statistic"><i class="fa fa-check"></i><b>35.6.5</b> F-statistic</a></li>
<li class="chapter" data-level="35.6.6" data-path="regress.html"><a href="regress.html#plotting-regression-results"><i class="fa fa-check"></i><b>35.6.6</b> Plotting regression results</a></li>
<li class="chapter" data-level="35.6.7" data-path="regress.html"><a href="regress.html#visualizing-residuals"><i class="fa fa-check"></i><b>35.6.7</b> Visualizing residuals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="36" data-path="nonlinearintro.html"><a href="nonlinearintro.html"><i class="fa fa-check"></i><b>36</b> Non-linear regression introduction</a><ul>
<li class="chapter" data-level="36.1" data-path="nonlinearintro.html"><a href="nonlinearintro.html#uses-for-nonlinear-regression"><i class="fa fa-check"></i><b>36.1</b> Uses for nonlinear regression</a></li>
<li class="chapter" data-level="36.2" data-path="nonlinearintro.html"><a href="nonlinearintro.html#nonlinear-models-and-parameters"><i class="fa fa-check"></i><b>36.2</b> Nonlinear models and parameters</a><ul>
<li class="chapter" data-level="36.2.1" data-path="nonlinearintro.html"><a href="nonlinearintro.html#hyperbolic-stimulus-response-functions"><i class="fa fa-check"></i><b>36.2.1</b> Hyperbolic stimulus response functions</a></li>
<li class="chapter" data-level="36.2.2" data-path="nonlinearintro.html"><a href="nonlinearintro.html#visualizing-nonlinear-data-and-log-scaling"><i class="fa fa-check"></i><b>36.2.2</b> Visualizing nonlinear data and log scaling</a></li>
</ul></li>
<li class="chapter" data-level="36.3" data-path="nonlinearintro.html"><a href="nonlinearintro.html#how-do-regression-fits-happen"><i class="fa fa-check"></i><b>36.3</b> How do regression fits happen?</a><ul>
<li class="chapter" data-level="36.3.1" data-path="nonlinearintro.html"><a href="nonlinearintro.html#selecting-the-right-model"><i class="fa fa-check"></i><b>36.3.1</b> Selecting the right model</a></li>
<li class="chapter" data-level="36.3.2" data-path="nonlinearintro.html"><a href="nonlinearintro.html#from-models-to-formulas"><i class="fa fa-check"></i><b>36.3.2</b> From models to formulas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="37" data-path="nestedregress.html"><a href="nestedregress.html"><i class="fa fa-check"></i><b>37</b> Nested-model nonlinear regression</a><ul>
<li class="chapter" data-level="37.1" data-path="nestedregress.html"><a href="nestedregress.html#read-and-plot-the-data"><i class="fa fa-check"></i><b>37.1</b> Read and plot the data</a></li>
<li class="chapter" data-level="37.2" data-path="nestedregress.html"><a href="nestedregress.html#perform-the-nonlinear-regression"><i class="fa fa-check"></i><b>37.2</b> Perform the nonlinear regression</a><ul>
<li class="chapter" data-level="37.2.1" data-path="nestedregress.html"><a href="nestedregress.html#troubleshooting-the-regression"><i class="fa fa-check"></i><b>37.2.1</b> Troubleshooting the regression</a></li>
<li class="chapter" data-level="37.2.2" data-path="nestedregress.html"><a href="nestedregress.html#interpreting-the-parameters"><i class="fa fa-check"></i><b>37.2.2</b> Interpreting the parameters</a></li>
<li class="chapter" data-level="37.2.3" data-path="nestedregress.html"><a href="nestedregress.html#residual-plots-to-compare-fits"><i class="fa fa-check"></i><b>37.2.3</b> Residual plots to compare fits</a></li>
<li class="chapter" data-level="37.2.4" data-path="nestedregress.html"><a href="nestedregress.html#compare-aic"><i class="fa fa-check"></i><b>37.2.4</b> Compare AIC</a></li>
<li class="chapter" data-level="37.2.5" data-path="nestedregress.html"><a href="nestedregress.html#other-ways-to-compare-models"><i class="fa fa-check"></i><b>37.2.5</b> Other ways to compare models</a></li>
<li class="chapter" data-level="37.2.6" data-path="nestedregress.html"><a href="nestedregress.html#interpretation-of-this-one-replicate"><i class="fa fa-check"></i><b>37.2.6</b> Interpretation of this one replicate</a></li>
<li class="chapter" data-level="37.2.7" data-path="nestedregress.html"><a href="nestedregress.html#alternate-analysis"><i class="fa fa-check"></i><b>37.2.7</b> Alternate analysis</a></li>
</ul></li>
<li class="chapter" data-level="37.3" data-path="nestedregress.html"><a href="nestedregress.html#summary-2"><i class="fa fa-check"></i><b>37.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="nonlinearreplicates.html"><a href="nonlinearreplicates.html"><i class="fa fa-check"></i><b>38</b> Nonlinear regression of independent replicates</a><ul>
<li class="chapter" data-level="38.1" data-path="nonlinearreplicates.html"><a href="nonlinearreplicates.html#the-dataset"><i class="fa fa-check"></i><b>38.1</b> The dataset</a></li>
<li class="chapter" data-level="38.2" data-path="nonlinearreplicates.html"><a href="nonlinearreplicates.html#munging-for-regression-analysis"><i class="fa fa-check"></i><b>38.2</b> Munging for regression analysis</a><ul>
<li class="chapter" data-level="38.2.1" data-path="nonlinearreplicates.html"><a href="nonlinearreplicates.html#average-the-technical-replicates"><i class="fa fa-check"></i><b>38.2.1</b> Average the technical replicates</a></li>
<li class="chapter" data-level="38.2.2" data-path="nonlinearreplicates.html"><a href="nonlinearreplicates.html#create-one-table"><i class="fa fa-check"></i><b>38.2.2</b> Create one table</a></li>
<li class="chapter" data-level="38.2.3" data-path="nonlinearreplicates.html"><a href="nonlinearreplicates.html#plot-the-data-1"><i class="fa fa-check"></i><b>38.2.3</b> Plot the data</a></li>
<li class="chapter" data-level="38.2.4" data-path="nonlinearreplicates.html"><a href="nonlinearreplicates.html#clean-up-regression-results"><i class="fa fa-check"></i><b>38.2.4</b> Clean up regression results</a></li>
</ul></li>
<li class="chapter" data-level="38.3" data-path="nonlinearreplicates.html"><a href="nonlinearreplicates.html#t-test-on-half-lives"><i class="fa fa-check"></i><b>38.3</b> T-test on half-lives</a></li>
<li class="chapter" data-level="38.4" data-path="nonlinearreplicates.html"><a href="nonlinearreplicates.html#conclusion"><i class="fa fa-check"></i><b>38.4</b> Conclusion</a></li>
<li class="chapter" data-level="38.5" data-path="nonlinearreplicates.html"><a href="nonlinearreplicates.html#summary-figure"><i class="fa fa-check"></i><b>38.5</b> Summary figure</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="multregress.html"><a href="multregress.html"><i class="fa fa-check"></i><b>39</b> Multiple regression</a><ul>
<li class="chapter" data-level="39.1" data-path="multregress.html"><a href="multregress.html#the-linear-regression-model-1"><i class="fa fa-check"></i><b>39.1</b> The linear regression model</a></li>
<li class="chapter" data-level="39.2" data-path="multregress.html"><a href="multregress.html#multiple-regression-models"><i class="fa fa-check"></i><b>39.2</b> Multiple regression models</a></li>
<li class="chapter" data-level="39.3" data-path="multregress.html"><a href="multregress.html#experimental-multiple-regression"><i class="fa fa-check"></i><b>39.3</b> Experimental multiple regression</a><ul>
<li class="chapter" data-level="39.3.1" data-path="multregress.html"><a href="multregress.html#a-one-factor-experiment-with-3-groups"><i class="fa fa-check"></i><b>39.3.1</b> A one factor experiment with 3 groups</a></li>
<li class="chapter" data-level="39.3.2" data-path="multregress.html"><a href="multregress.html#a-two-factor-experiment-with-6-groups"><i class="fa fa-check"></i><b>39.3.2</b> A two factor experiment with 6 groups</a></li>
</ul></li>
<li class="chapter" data-level="39.4" data-path="multregress.html"><a href="multregress.html#multiple-linear-mixed-models"><i class="fa fa-check"></i><b>39.4</b> Multiple linear mixed models</a></li>
<li class="chapter" data-level="39.5" data-path="multregress.html"><a href="multregress.html#multiple-regression-of-observational-data"><i class="fa fa-check"></i><b>39.5</b> Multiple regression of observational data</a></li>
</ul></li>
<li class="chapter" data-level="40" data-path="logregress.html"><a href="logregress.html"><i class="fa fa-check"></i><b>40</b> Logistic regression</a><ul>
<li class="chapter" data-level="40.1" data-path="logregress.html"><a href="logregress.html#uses-of-logistic-regression"><i class="fa fa-check"></i><b>40.1</b> Uses of logistic regression</a><ul>
<li class="chapter" data-level="40.1.1" data-path="logregress.html"><a href="logregress.html#sidebar-doing-logistic-regression-is-machine-learning"><i class="fa fa-check"></i><b>40.1.1</b> Sidebar: Doing logistic regression is machine learning</a></li>
</ul></li>
<li class="chapter" data-level="40.2" data-path="logregress.html"><a href="logregress.html#derivation-of-the-logistic-regression-model"><i class="fa fa-check"></i><b>40.2</b> Derivation of the logistic regression model</a><ul>
<li class="chapter" data-level="40.2.1" data-path="logregress.html"><a href="logregress.html#relationship-of-logit-to-odds-to-the-model-coefficients-and-probability"><i class="fa fa-check"></i><b>40.2.1</b> Relationship of logit to odds to the model coefficients and probability</a></li>
<li class="chapter" data-level="40.2.2" data-path="logregress.html"><a href="logregress.html#additional-types-of-logistic-regression-models"><i class="fa fa-check"></i><b>40.2.2</b> Additional types of logistic regression models</a></li>
</ul></li>
<li class="chapter" data-level="40.3" data-path="logregress.html"><a href="logregress.html#stress-and-survival"><i class="fa fa-check"></i><b>40.3</b> Stress and survival</a><ul>
<li class="chapter" data-level="40.3.1" data-path="logregress.html"><a href="logregress.html#interpretation-of-output"><i class="fa fa-check"></i><b>40.3.1</b> Interpretation of output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="41" data-path="mixedlogistic.html"><a href="mixedlogistic.html"><i class="fa fa-check"></i><b>41</b> Mixed model logistic regression</a><ul>
<li class="chapter" data-level="41.1" data-path="mixedlogistic.html"><a href="mixedlogistic.html#mixed-models-fixed-and-random-effects"><i class="fa fa-check"></i><b>41.1</b> Mixed models, fixed and random effects</a><ul>
<li class="chapter" data-level="41.1.1" data-path="mixedlogistic.html"><a href="mixedlogistic.html#nfat-localization-within-smooth-muscle-cells"><i class="fa fa-check"></i><b>41.1.1</b> NFAT localization within smooth muscle cells</a></li>
</ul></li>
<li class="chapter" data-level="41.2" data-path="mixedlogistic.html"><a href="mixedlogistic.html#data-1"><i class="fa fa-check"></i><b>41.2</b> Data</a><ul>
<li class="chapter" data-level="41.2.1" data-path="mixedlogistic.html"><a href="mixedlogistic.html#inference-1"><i class="fa fa-check"></i><b>41.2.1</b> Inference</a></li>
</ul></li>
<li class="chapter" data-level="41.3" data-path="mixedlogistic.html"><a href="mixedlogistic.html#alternative-analysis"><i class="fa fa-check"></i><b>41.3</b> Alternative analysis</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">JABSTB: Statistical Design and Analysis of Experiments with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ttestmc" class="section level1">
<h1><span class="header-section-number">Chapter 23</span> Statistical design of t-tests</h1>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb418-1" title="1"><span class="kw">library</span>(datapasta)</a>
<a class="sourceLine" id="cb418-2" title="2"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<div id="about-this-chapter" class="section level2">
<h2><span class="header-section-number">23.1</span> About this chapter</h2>
<p>This chapter walks through a statistical design for three different types of t-test experiments; the one-sample, the unpaired and the paired t-tests.</p>
<p>Each of these examples use Monte Carlo simulation to assess experimental power at given sample and effect sizes, so you’d know many replicates are needed for a real life experiment.</p>
<p>For preliminary data, these all use information in <a href="https://phenome.jax.org/projects/Jaxwest7">a mouse diabetes study conducted by the Jackson Labs</a>. This is done to illustrate how existing data can be used to refine predictions about the values we might expect in our own experiment.</p>
<div id="overview" class="section level3">
<h3><span class="header-section-number">23.1.1</span> Overview</h3>
<p>In a single cycle of a Monte Carlo t-test simulation, a random distribution function is used to simulate a random sample. This mimics how the values for replicates might be collected in a real life experiment. The key distinction between real life and simulated samples is that we know the true parameters of the sampled population for the latter…because we code them in!</p>
<p>That’s a key difference from real life, because it means we can assess how well the simulated samples lead to a correct answer.</p>
</div>
<div id="simulating-data" class="section level3">
<h3><span class="header-section-number">23.1.2</span> Simulating data</h3>
<p>In these t-test cases below, we’ll use the <code>rnorm</code> function to generate sample replicates. Ideally, t-tests are only used on dependent variables that are continuous and normally distributed. In this case, we’ll be simulating experiments that involve measuring glucose concentration, which is a continuous, normally distributed variable.</p>
<p>However, it is important to recognize that you should simulate the kind of data you expect to generate, irrespective of the shape of the distribution you are sampling. If you expect skewed data, for example, lognormal, then you should simulate data shaped like that!! The goal is to try to make the simulation as real life as possible.</p>
<p>Having a simulated sample of a proper sample size, a t-test is next configured to test that sample. We could collect any test parameter we wished from that t-test, but usually we just capture the p-value.</p>
<p>If we’re tesing at a 95% confidence level, then a p-value less than 0.05 would be counted as a “hit” indicating treatment effect.</p>
<p>A cycle of random sampling, t-testing, and p-value evaluation is repeated anywhere from 100 to 10000 times or more. How many? It depends upon how accurate you’d like to be.</p>
<p>The fraction of ‘hits’ relative to the number of simulated samples is the power of the test. The higher the number of simulations, the more accurate the Monte Carlo in terms of predicting “hits” and power.</p>
</div>
<div id="change-n-to-zero-in-on-the-power-you-want" class="section level3">
<h3><span class="header-section-number">23.1.3</span> Change n to zero in on the power you want</h3>
<p>If the result is not an acceptable power, change the sample size <code>n</code> in the <code>rnorm</code> function until a Monte Carlo simulation run gives you an acceptable fraction of ‘hits’. There’s your sample size, which is usually the output we want from running this simulation!</p>
<p>Furthermore, any other assumptions or conditions can be changed, too. Need to re-evaluate the predicted standard deviation? Change it! Will the effect size be larger or smaller than you think? Simulate that! Want to compare a one-tailed to a two-tailed hypothesis? Switch it up!</p>
<p>The time to do p-hacking and HARKing is during a Monte Carlo, before running the real life experiment.</p>
</div>
<div id="scenario" class="section level3">
<h3><span class="header-section-number">23.1.4</span> Scenario</h3>
<p>Let’s imagine we have developed a new drug we hope will be useful for treating type II diabetes. Pretend our role is to generate pre-clinical data in support of an FDA application.</p>
<p>The planning is based on <a href="https://phenome.jax.org/projects/Jaxwest7">some mouse phenome data in a diet-induced obesity study in a fancy mouse strain</a>, which is a common model for type II diabetes.</p>
</div>
<div id="what-would-be-a-scientifically-meaningful-response" class="section level3">
<h3><span class="header-section-number">23.1.5</span> What would be a scientifically meaningful response?</h3>
<p>A key decision in setting up the Monte Carlo is to predict the mean and standard deviations of the population being sampled along with the effect size of the treatment.</p>
<p>On the basis of expertise in the field, we make the judgment that a 50% reduction in blood glucose caused by the drug in this diet-induced obesity model would be a scientifically meaningful outcome. We need to design an experiment capable of detecting that 50% effect size.</p>
<p>We’ve <a href="jaxwest7.html#jaxwest7">already compiled the phenome data into summary format</a>. We’ll use that to guide our estimates in these Monte Carlo. These data show that under diabetogenic conditions the animals have an average blood glucose of 368 and SD = 119 (mg glucose/dl).</p>
<p>Since this is an exercise in prediction and estimation, we’ll round those values to 370 and 120, if only to make the point that highly precise numbers misses the point of what we’re doing here.</p>
<p>A 50% reduction would yield a target value of about 185 mg/dl.</p>
<p>Finally, we’d like to run the real life experiments at 90% power. Why? Let’s imagine that these are a pretty important test: a “go” vs “no go” inflection point for a novel drug candidate. When the stakes are high so too should be the power of the test.</p>
</div>
</div>
<div id="one-sample-t-test-monte-carlo" class="section level2">
<h2><span class="header-section-number">23.2</span> One sample t-test Monte Carlo</h2>
<p>In this single arm design, all C57Bl/6J mice are enrolled in an diabetogenic protocol would receive the drug treatment. Blood glucose levels are taken at the end of a proscribed period.</p>
<p>The statistical test evaluates the null hypothesis, that mean blood glucose with drug treatment does not differ from the mean blood glucose <em>that would be expected</em> in animals that undergo the diabetogenic protocol.</p>
<p>There is no formal placebo control group.</p>
<p>Step 1: Enter mean and sd parameter estimates for the expected effect of the new drug. The sd estimate is a judgment call to think through and to model out. The entry below is conservative. It assumes the drug-treated group has the same sd as an untreated group. The Jaxwest7 data suggest a lower sd might happen with drug (the sd was 80 for the rosiglitazone group).</p>
<p>Also enter an estimate for the theoretical mean of the population it will be evaluated against. Finally, enter a value for the sample size of the drug-treated group.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb419-1" title="1">meanDrug &lt;-<span class="st"> </span><span class="dv">185</span></a>
<a class="sourceLine" id="cb419-2" title="2">sdDrug &lt;-<span class="st"> </span><span class="dv">120</span></a>
<a class="sourceLine" id="cb419-3" title="3"></a>
<a class="sourceLine" id="cb419-4" title="4">muCon &lt;-<span class="st"> </span><span class="dv">370</span></a>
<a class="sourceLine" id="cb419-5" title="5"></a>
<a class="sourceLine" id="cb419-6" title="6">nDrug &lt;-<span class="st"> </span><span class="dv">5</span></a></code></pre></div>
<p>Step 2: Declare relevant arguments for the t-test function:</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb420-1" title="1">alt =<span class="st">&quot;two.sided&quot;</span></a>
<a class="sourceLine" id="cb420-2" title="2">pairing =<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb420-3" title="3">var =<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb420-4" title="4">alpha=<span class="fl">0.05</span></a></code></pre></div>
<p>Step 3: Declare the number of simulations for the experiment and set up an empty vector to collect p-values generated by the function.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb421-1" title="1">nSims &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb421-2" title="2">p &lt;-<span class="st"> </span><span class="kw">c</span>()</a></code></pre></div>
<p>Step 4: Run the simulation function. Notice how with each loop it simulates a new random sample then runs a on-sample t-test on that sample, then stores the p-value in a vector that grows with each loop.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb422-1" title="1"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nSims){</a>
<a class="sourceLine" id="cb422-2" title="2">  x&lt;-<span class="kw">rnorm</span>(<span class="dt">n =</span> nDrug, </a>
<a class="sourceLine" id="cb422-3" title="3">           <span class="dt">mean =</span> meanDrug, </a>
<a class="sourceLine" id="cb422-4" title="4">           <span class="dt">sd =</span> sdDrug)</a>
<a class="sourceLine" id="cb422-5" title="5">  </a>
<a class="sourceLine" id="cb422-6" title="6">  z&lt;-<span class="kw">t.test</span>(x, </a>
<a class="sourceLine" id="cb422-7" title="7">            <span class="dt">alternative =</span> alt,</a>
<a class="sourceLine" id="cb422-8" title="8">            <span class="dt">paired =</span> pairing,</a>
<a class="sourceLine" id="cb422-9" title="9">            <span class="dt">mu=</span>muCon, </a>
<a class="sourceLine" id="cb422-10" title="10">            <span class="dt">var.equal =</span> var, </a>
<a class="sourceLine" id="cb422-11" title="11">            <span class="dt">conf.level =</span> <span class="dv">1</span><span class="op">-</span>alpha) </a>
<a class="sourceLine" id="cb422-12" title="12">  </a>
<a class="sourceLine" id="cb422-13" title="13">  p[i]&lt;-z<span class="op">$</span>p.value <span class="co">#get the p-value and store it</span></a>
<a class="sourceLine" id="cb422-14" title="14">}</a></code></pre></div>
<p>Step 5: Calculate and show “hits” and power. Remember, a “hit” is a simulation with a p-value &lt; 0.05. Power is the fraction of all simulations that meet this hit critria.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb423-1" title="1"><span class="co"># the output</span></a>
<a class="sourceLine" id="cb423-2" title="2"></a>
<a class="sourceLine" id="cb423-3" title="3">hits &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">which</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)); hits</a></code></pre></div>
<pre><code>## [1] 748</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb425-1" title="1">power &lt;-<span class="st"> </span>hits<span class="op">/</span>nSims; power</a></code></pre></div>
<pre><code>## [1] 0.748</code></pre>
<p>Step 6: Visualize the p-value output with a histogram. Because it’s pretty.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb427-1" title="1"><span class="co">#now plot the histogram</span></a>
<a class="sourceLine" id="cb427-2" title="2"></a>
<a class="sourceLine" id="cb427-3" title="3"><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(p))<span class="op">+</span></a>
<a class="sourceLine" id="cb427-4" title="4"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(p), </a>
<a class="sourceLine" id="cb427-5" title="5">                 <span class="dt">color=</span><span class="st">&quot;#f2a900&quot;</span>,</a>
<a class="sourceLine" id="cb427-6" title="6">                 <span class="dt">fill=</span><span class="st">&quot;#012169&quot;</span>, </a>
<a class="sourceLine" id="cb427-7" title="7">                 <span class="dt">bins=</span><span class="dv">20</span>)</a></code></pre></div>
<p><img src="jabstb_files/figure-html/unnamed-chunk-233-1.png" width="672" /></p>
<p>Next steps: The returned power for the estimates above is about 75%. That’s a bit lower than a power of 90%, which we’d like here. Change the value of the <code>nDrug</code> term to a higher sample size, before re-running the simulation loops, until a power of ~90% is achieved. You can also change the estimate for <code>sdDrug</code>, too. How does lowering that influence sample size for 90% power?</p>
<p>Why 90%? That’s both a scientific and strategic call. In this instance a positive result will have important implications for committing further to a costly drug development process. For that reason, the study should be run at a higher power than what might be chosen for a test that is more exploratory in nature.</p>
</div>
<div id="unpaired-t-test-monte-carlo" class="section level2">
<h2><span class="header-section-number">23.3</span> Unpaired t-test Monte Carlo</h2>
<p>This is an alternative experimental design to the one above. A group is used to directly measure glucose concentration in placebo control for comparison to the drug effect, rather than assume what the glucose concentration would be in the placebo control</p>
<p>This design therefore involves two groups of animals. All animals would be subjected to the diabetes-inducing diet. In the control arm, the group would receive a placebo. In the experimental arm, the group would receive the new drug. Each animal would be assumed as statistically independent of every other animal.</p>
<p>The objective is to test the null hypothesis that the means of the blood glucose concentrations do not differ between the two groups.</p>
<p>Step 1: Let’s call the “A” group the placebo, and the “B” group the drug treated. We’ll use standard deviation and the mean estimates for blood glucose levels as described above. We’ll design for equal sample sizes, though this test can tolerate differences.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb428-1" title="1"><span class="co">#Sampled population paramemters</span></a>
<a class="sourceLine" id="cb428-2" title="2"></a>
<a class="sourceLine" id="cb428-3" title="3"><span class="co"># sample A placebo</span></a>
<a class="sourceLine" id="cb428-4" title="4">meanA &lt;-<span class="st"> </span><span class="dv">380</span></a>
<a class="sourceLine" id="cb428-5" title="5">sdA &lt;-<span class="st"> </span><span class="dv">120</span></a>
<a class="sourceLine" id="cb428-6" title="6">nA &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb428-7" title="7"></a>
<a class="sourceLine" id="cb428-8" title="8"><span class="co"># sample B new drug</span></a>
<a class="sourceLine" id="cb428-9" title="9">meanB &lt;-<span class="st"> </span><span class="dv">190</span></a>
<a class="sourceLine" id="cb428-10" title="10">sdB &lt;-<span class="st"> </span><span class="dv">120</span></a>
<a class="sourceLine" id="cb428-11" title="11">nB &lt;-<span class="st"> </span><span class="dv">5</span></a></code></pre></div>
<p>Step 2: Set the t-test function arguments as initializers, rather than down in the loop function, so they are easy to read and to modify.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb429-1" title="1"><span class="co">#t-test function arguments</span></a>
<a class="sourceLine" id="cb429-2" title="2">alt&lt;-<span class="st"> &quot;two.sided&quot;</span></a>
<a class="sourceLine" id="cb429-3" title="3">pairing &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb429-4" title="4">var &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb429-5" title="5">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a></code></pre></div>
<p>Step 3: Declare the number of simulations. The larger the number of simulations, the more accurate will be the power calculation. Also set up an empty vector for the following function to fill as it cycles through simulations and generates p-values.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb430-1" title="1">nSims &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of simulated experiments</span></a>
<a class="sourceLine" id="cb430-2" title="2">p &lt;-<span class="st"> </span><span class="kw">c</span>()</a></code></pre></div>
<p>Step 4: Run the simulation function.</p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb431-1" title="1"><span class="co"># the monte carlo function</span></a>
<a class="sourceLine" id="cb431-2" title="2"></a>
<a class="sourceLine" id="cb431-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nSims){ <span class="co">#for each simulated experiment</span></a>
<a class="sourceLine" id="cb431-4" title="4">  x&lt;-<span class="kw">rnorm</span>(<span class="dt">n =</span> nA, <span class="dt">mean =</span> meanA, <span class="dt">sd =</span> sdA) <span class="co">#produce n simulated participants</span></a>
<a class="sourceLine" id="cb431-5" title="5">  <span class="co">#with mean and SD</span></a>
<a class="sourceLine" id="cb431-6" title="6">  y&lt;-<span class="kw">rnorm</span>(<span class="dt">n =</span> nB, <span class="dt">mean =</span> meanB, <span class="dt">sd =</span> sdB) <span class="co">#produce n simulated participants</span></a>
<a class="sourceLine" id="cb431-7" title="7">  <span class="co">#with mean and SD</span></a>
<a class="sourceLine" id="cb431-8" title="8">  z&lt;-<span class="kw">t.test</span>(x,y, </a>
<a class="sourceLine" id="cb431-9" title="9">            <span class="dt">alternative =</span> alt, </a>
<a class="sourceLine" id="cb431-10" title="10">            <span class="dt">paired =</span> pairing, </a>
<a class="sourceLine" id="cb431-11" title="11">            <span class="dt">var.equal =</span> var, </a>
<a class="sourceLine" id="cb431-12" title="12">            <span class="dt">conf.level =</span> <span class="dv">1</span><span class="op">-</span>alpha) <span class="co">#perform the t-test</span></a>
<a class="sourceLine" id="cb431-13" title="13">  </a>
<a class="sourceLine" id="cb431-14" title="14">  p[i]&lt;-z<span class="op">$</span>p.value <span class="co">#get the p-value and store it</span></a>
<a class="sourceLine" id="cb431-15" title="15">}</a></code></pre></div>
<p>Step 5: Print out the power, which is the number of “significant” results divided by the total number of simulations.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb432-1" title="1"><span class="co"># the output</span></a>
<a class="sourceLine" id="cb432-2" title="2"></a>
<a class="sourceLine" id="cb432-3" title="3">hits &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">which</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)); hits</a></code></pre></div>
<pre><code>## [1] 5973</code></pre>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb434-1" title="1">power &lt;-<span class="st"> </span>hits<span class="op">/</span>nSims; power</a></code></pre></div>
<pre><code>## [1] 0.5973</code></pre>
<p>Step 6: Plot out the distribution of p-values.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb436-1" title="1"><span class="co">#now plot the histogram</span></a>
<a class="sourceLine" id="cb436-2" title="2"></a>
<a class="sourceLine" id="cb436-3" title="3"><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(p))<span class="op">+</span></a>
<a class="sourceLine" id="cb436-4" title="4"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(p), </a>
<a class="sourceLine" id="cb436-5" title="5">                 <span class="dt">color=</span><span class="st">&quot;#f2a900&quot;</span>, </a>
<a class="sourceLine" id="cb436-6" title="6">                 <span class="dt">fill=</span><span class="st">&quot;#012169&quot;</span>, </a>
<a class="sourceLine" id="cb436-7" title="7">                 <span class="dt">bins=</span><span class="dv">20</span>)</a></code></pre></div>
<p><img src="jabstb_files/figure-html/unnamed-chunk-239-1.png" width="672" /></p>
<p>Next steps: This configuration with a sample size of 5 in each group is a bit underpowered. Adjust these sample sizes to dervied a power of about 90%. Also experiment with adjusting other features of the test. What happens if the SD for the drug-treated group is lower? What about a one-tailed hypothesis instead of a two-sided? Monte Carlo is the time for p-hacking and harking.</p>
</div>
<div id="paired-t-test-monte-carlo" class="section level2">
<h2><span class="header-section-number">23.4</span> Paired t-test Monte Carlo</h2>
<p>Another way to test whether the new drug can reduce blood sugar concentrations is by using a paired design. Paired designs offer some level of control over random variability by accounting for some of it to the variation within subjects.</p>
<p>For example, individuals may differ wildly in their absolute blood glucose concentrations, but the proportional change due to drug from subject to another will be fairly consistent.</p>
<p>The paired t-test challenges the null hypothesis that the average change in blood glucose caused by the drug is zero.</p>
<p>Step 1: When simulating data for a paired design it is important to account for the expected correlation between variables. That’s best accomplished on the basis of some data.</p>
<p>We can use the serial glucose measurements from individual subjects in the <a href="%7B#jaxwest7%7D">Jaxwest7 data set to extract this information</a>.</p>
<p>There are two daily blood glucose measurements taken on days 1, 3, 5, 7, 9, 11 and 12 of a study, from each of 16 different subjects. We can think of each blood collection as a variable, for which 16 independent replicate measurements are taken.</p>
<p>Across the blood collections we expect to see high correlation within the replicates. In other words, animals with high values should be consistently high across the study period, and animals with low values should be consistently low across the same time frame.</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb437-1" title="1"><span class="co">#Copying cells F14:S32 of the Jaxwest7 table (the value at F21 was imputed as the average of its row before pasting) using the datapasta package. </span></a>
<a class="sourceLine" id="cb437-2" title="2"></a>
<a class="sourceLine" id="cb437-3" title="3">bloodGlucose &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb437-4" title="4">                     <span class="dt">day01 =</span> <span class="kw">c</span>(136L, 345L, 190L, 434L, 424L, 170L, 487L, 218L, 179L, 260L,</a>
<a class="sourceLine" id="cb437-5" title="5">                                 115L, 526L, 325L, 329L, 230L, 204L),</a>
<a class="sourceLine" id="cb437-6" title="6">                     <span class="dt">day01 =</span> <span class="kw">c</span>(270L, 518L, 301L, 504L, 486L, 208L, 449L, 273L, 184L, 381L,</a>
<a class="sourceLine" id="cb437-7" title="7">                                 191L, 517L, 252L, 296L, 414L, 120L),</a>
<a class="sourceLine" id="cb437-8" title="8">                     <span class="dt">day03 =</span> <span class="kw">c</span>(162L, 429L, 311L, 453L, 447L, 134L, 525L, 254L, 124L, 174L,</a>
<a class="sourceLine" id="cb437-9" title="9">                                 132L, 465L, 203L, 212L, 408L, 138L),</a>
<a class="sourceLine" id="cb437-10" title="10">                     <span class="dt">day03 =</span> <span class="kw">c</span>(165L, 413L, 361L, 392L, 417L, 129L, 419L, 265L, 107L, 140L,</a>
<a class="sourceLine" id="cb437-11" title="11">                                 132L, 394L, 158L, 159L, 179L, 139L),</a>
<a class="sourceLine" id="cb437-12" title="12">                     <span class="dt">day05 =</span> <span class="kw">c</span>(192L, 456L, 398L, 350L, 496L, 147L, 437L, 338L, 108L, 132L,</a>
<a class="sourceLine" id="cb437-13" title="13">                                 169L, 310L, 135L, 156L, 432L, 157L),</a>
<a class="sourceLine" id="cb437-14" title="14">                     <span class="dt">day05 =</span> <span class="kw">c</span>(397L, 487L, 465L, 400L, 484L, 141L, 476L, 386L, 149L, 138L,</a>
<a class="sourceLine" id="cb437-15" title="15">                                 158L, 269L, 162L, 200L, 288L, 122L),</a>
<a class="sourceLine" id="cb437-16" title="16">                     <span class="dt">day07 =</span> <span class="kw">c</span>(172L, 468L, 388L, 458L, 468L, 241L, 525L, 287L, 142L, 164L,</a>
<a class="sourceLine" id="cb437-17" title="17">                                 129L, 213L, 164L, 139L, 163L, 163L),</a>
<a class="sourceLine" id="cb437-18" title="18">                     <span class="dt">day07 =</span> <span class="kw">c</span>(148L, 419L, 392L, 387L, 423L, 128L, 499L, 236L, 143L, 137L,</a>
<a class="sourceLine" id="cb437-19" title="19">                                 120L, 185L, 181L, 143L, 240L, 168L),</a>
<a class="sourceLine" id="cb437-20" title="20">                     <span class="dt">day09 =</span> <span class="kw">c</span>(291L, 507L, 453L, 342L, 472L, 162L, 516L, 347L, 112L, 122L,</a>
<a class="sourceLine" id="cb437-21" title="21">                                 122L, 145L, 150L, 164L, 185L, 164L),</a>
<a class="sourceLine" id="cb437-22" title="22">                     <span class="dt">day09 =</span> <span class="kw">c</span>(239L, 559L, 421L, 368L, 507L, 163L, 485L, 235L, 233L, 140L,</a>
<a class="sourceLine" id="cb437-23" title="23">                                 157L, 201L, 177L, 150L, 208L, 128L),</a>
<a class="sourceLine" id="cb437-24" title="24">                     <span class="dt">day11 =</span> <span class="kw">c</span>(192L, 420L, 355L, 355L, 458L, 222L, 472L, 432L, 113L, 102L,</a>
<a class="sourceLine" id="cb437-25" title="25">                                 94L, 131L, 162L, 119L, 138L, 129L),</a>
<a class="sourceLine" id="cb437-26" title="26">                     <span class="dt">day11 =</span> <span class="kw">c</span>(172L, 415L, 381L, 429L, 456L, 438L, 535L, 450L, 137L, 174L,</a>
<a class="sourceLine" id="cb437-27" title="27">                                 141L, 258L, 192L, 193L, 208L, 218L),</a>
<a class="sourceLine" id="cb437-28" title="28">                     <span class="dt">day12 =</span> <span class="kw">c</span>(235L, 511L, 394L, 373L, 519L, 307L, 500L, 509L, 106L, 120L,</a>
<a class="sourceLine" id="cb437-29" title="29">                                 120L, 114L, 170L, 148L, 153L, 135L),</a>
<a class="sourceLine" id="cb437-30" title="30">                     <span class="dt">day12 =</span> <span class="kw">c</span>(153L, 464L, 444L, 501L, 570L, 252L, 497L, 326L, 150L, 135L,</a>
<a class="sourceLine" id="cb437-31" title="31">                                 166L, 160L, 162L, 188L, 140L, 182L)</a>
<a class="sourceLine" id="cb437-32" title="32">                )</a></code></pre></div>
<p>We calculate the correlation between any two daily sets of values. In fact, we can calculate the correlation between all possible pairs of daily values. This leaves us with a large number of unique correlation coefficients. We then derive from these an overall average correlation coefficient for use in Monte Carlo function.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb438-1" title="1"><span class="co">#create a full correlation matrix</span></a>
<a class="sourceLine" id="cb438-2" title="2">cormat &lt;-<span class="st"> </span><span class="kw">cor</span>(bloodGlucose) </a>
<a class="sourceLine" id="cb438-3" title="3"><span class="co">#remove lower half of matrix</span></a>
<a class="sourceLine" id="cb438-4" title="4">cormat[<span class="kw">lower.tri</span>(cormat)] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb438-5" title="5"><span class="co">#remove matrix diagonal</span></a>
<a class="sourceLine" id="cb438-6" title="6">cormat[cormat<span class="op">==</span><span class="fl">1.0000000</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a></code></pre></div>
<p>How correlated are the glucose levels in the Jaxwest7 data set?</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb439-1" title="1"><span class="co">#calculate the average correlation coefficient among all the correlations in the Jaxwest7 glucose level data set</span></a>
<a class="sourceLine" id="cb439-2" title="2"><span class="kw">mean</span>(cormat, <span class="dt">na.rm=</span>T)</a></code></pre></div>
<pre><code>## [1] 0.7665732</code></pre>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb441-1" title="1"><span class="co">#phew!</span></a></code></pre></div>
<p>What does this value mean?</p>
<p>First, it can be show that when the value of the correlation coefficient between the variables <span class="math inline">\(X,Y\)</span> is <span class="math inline">\(r\)</span>, then the relationship between each pair of <span class="math inline">\(x_i, y_i\)</span> values in the set is <span class="math display">\[y_i=x_i\times r+y_i\sqrt{1-r^2}\]</span></p>
<p>Intuitively, this should make sense. You can see, when <span class="math inline">\(r=0\)</span>, then <span class="math inline">\(y_i=y_i\)</span>. When <span class="math inline">\(r=1\)</span>, then, <span class="math inline">\(y_i=x_i\)</span>)</p>
<p>So the correlation coefficeint from the Jaxwest7 data set means that <em>within</em> each subject in our experiment the expected correlation between pre-drug glucose concentrations and post-drug glucose concentrations is 0.7666.</p>
<p><strong>Step 2:</strong> Initialize the Monte Carlo with estimates for the measurement values. We start with the mean and sd values for the pre-drug blood glucose measurements. Their estimates are derived from the placebo group in the Jaxwest7 data set, rounded to 380 and 120, respectively.</p>
<p>A scientifically-meaningful effect of the drug would be a 50% reduction in glucose. We want to set up an experiment that can detect that effect.</p>
<p>The expected correlation between pairs of measures is 0.7666, rounded to 0.75.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb442-1" title="1"><span class="co">#Sampled population paramemters</span></a>
<a class="sourceLine" id="cb442-2" title="2"></a>
<a class="sourceLine" id="cb442-3" title="3"><span class="co"># pre-drug measurements</span></a>
<a class="sourceLine" id="cb442-4" title="4">mean1 &lt;-<span class="st"> </span><span class="dv">185</span></a>
<a class="sourceLine" id="cb442-5" title="5">sd1 &lt;-<span class="st"> </span><span class="dv">120</span></a>
<a class="sourceLine" id="cb442-6" title="6"></a>
<a class="sourceLine" id="cb442-7" title="7"><span class="co"># post-drug response</span></a>
<a class="sourceLine" id="cb442-8" title="8">mean2 &lt;-<span class="st"> </span><span class="dv">380</span></a>
<a class="sourceLine" id="cb442-9" title="9">sd2 &lt;-<span class="st"> </span><span class="dv">120</span></a>
<a class="sourceLine" id="cb442-10" title="10"></a>
<a class="sourceLine" id="cb442-11" title="11">r &lt;-<span class="st"> </span><span class="fl">0.75</span></a>
<a class="sourceLine" id="cb442-12" title="12"></a>
<a class="sourceLine" id="cb442-13" title="13">k &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>r<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb442-14" title="14"></a>
<a class="sourceLine" id="cb442-15" title="15"><span class="co"># number of paired measures</span></a>
<a class="sourceLine" id="cb442-16" title="16"></a>
<a class="sourceLine" id="cb442-17" title="17">pairs &lt;-<span class="st"> </span><span class="dv">3</span></a></code></pre></div>
<p><strong>Step 3:</strong> This step sets the arguments in the t-test function. Even though we predict a reduction in glucose, we’ll test this as a two-tailed hypothesis. It’s a little more stringent.</p>
<p>The <code>t.test</code> function needs to be set for <code>paired=TRUE</code> so that it runs the appropriate test.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb443-1" title="1"><span class="co">#t-test function arguments</span></a>
<a class="sourceLine" id="cb443-2" title="2">alt&lt;-<span class="st"> &quot;two.sided&quot;</span></a>
<a class="sourceLine" id="cb443-3" title="3">pairing &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb443-4" title="4">var &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb443-5" title="5">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a></code></pre></div>
<p><strong>Step 4:</strong> Declare the number of simulations. The larger the number of simulations, the more accurate will be the power calculation.</p>
<p>Also set up an empty vector to fill with p-values, as they are generated each cycle.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb444-1" title="1">nSims &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of simulated experiments</span></a>
<a class="sourceLine" id="cb444-2" title="2">p &lt;-<span class="st"> </span><span class="kw">c</span>()</a></code></pre></div>
<p><strong>Step 5:</strong> Re-simulate and re-run the t-test <code>nSims</code> times.</p>
<p>The <code>y1</code> and <code>y2</code> vectors are each a set of randomly generated values for the post- and pre-drug measurements, respectively. Both measures need to be simulated as random variables. But the <code>y2</code> vector needs to be corrected for its correlation with <code>y1</code>.</p>
<p><em>NOTE</em> The correlation only works by always simulating the lower of two mean values as <code>y1</code>.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb445-1" title="1"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nSims){ <span class="co">#for each simulated experiment</span></a>
<a class="sourceLine" id="cb445-2" title="2">  y1&lt;-<span class="kw">rnorm</span>(<span class="dt">n =</span> pairs, <span class="dt">mean =</span> mean1, <span class="dt">sd =</span> sd1) <span class="co">#produce n simulated participants</span></a>
<a class="sourceLine" id="cb445-3" title="3">  <span class="co">#with mean and SD</span></a>
<a class="sourceLine" id="cb445-4" title="4">  y2&lt;-<span class="kw">rnorm</span>(<span class="dt">n =</span> pairs, <span class="dt">mean =</span> mean2, <span class="dt">sd =</span> sd2) <span class="co">#produce n simulated participants</span></a>
<a class="sourceLine" id="cb445-5" title="5">  <span class="co">#with mean and SD</span></a>
<a class="sourceLine" id="cb445-6" title="6">  <span class="co">#correlated</span></a>
<a class="sourceLine" id="cb445-7" title="7">  y2 &lt;-<span class="st"> </span>r<span class="op">*</span>y1<span class="op">+</span>k<span class="op">*</span>y2</a>
<a class="sourceLine" id="cb445-8" title="8">  z&lt;-<span class="kw">t.test</span>(y1,y2, </a>
<a class="sourceLine" id="cb445-9" title="9">            <span class="dt">alternative=</span>alt, </a>
<a class="sourceLine" id="cb445-10" title="10">            <span class="dt">paired=</span>pairing,</a>
<a class="sourceLine" id="cb445-11" title="11">            <span class="dt">var.equal=</span>var, </a>
<a class="sourceLine" id="cb445-12" title="12">            <span class="dt">conf.level=</span><span class="dv">1</span><span class="op">-</span>alpha) <span class="co">#perform the t-test</span></a>
<a class="sourceLine" id="cb445-13" title="13">  </a>
<a class="sourceLine" id="cb445-14" title="14">  p[i]&lt;-z<span class="op">$</span>p.value <span class="co">#get the p-value and store it</span></a>
<a class="sourceLine" id="cb445-15" title="15">}</a></code></pre></div>
<p><strong>Step 6:</strong> Calculate power as the fraction of p-values less than 0.05.</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb446-1" title="1"><span class="co"># the output</span></a>
<a class="sourceLine" id="cb446-2" title="2"></a>
<a class="sourceLine" id="cb446-3" title="3">hits &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">which</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)); hits</a></code></pre></div>
<pre><code>## [1] 5937</code></pre>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb448-1" title="1">power &lt;-<span class="st"> </span>hits<span class="op">/</span>nSims; power</a></code></pre></div>
<pre><code>## [1] 0.5937</code></pre>
<p><strong>Step 7:</strong> Visualize the p-value distribution.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb450-1" title="1"><span class="co">#now plot the histogram</span></a>
<a class="sourceLine" id="cb450-2" title="2"></a>
<a class="sourceLine" id="cb450-3" title="3"><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(p))<span class="op">+</span></a>
<a class="sourceLine" id="cb450-4" title="4"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(p), </a>
<a class="sourceLine" id="cb450-5" title="5">                 <span class="dt">color=</span><span class="st">&quot;#f2a900&quot;</span>, </a>
<a class="sourceLine" id="cb450-6" title="6">                 <span class="dt">fill=</span><span class="st">&quot;#012169&quot;</span>, </a>
<a class="sourceLine" id="cb450-7" title="7">                 <span class="dt">bins=</span><span class="dv">20</span>)</a></code></pre></div>
<p><img src="jabstb_files/figure-html/unnamed-chunk-248-1.png" width="672" /></p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb451-1" title="1"><span class="kw">library</span>(pwr)</a>
<a class="sourceLine" id="cb451-2" title="2"></a>
<a class="sourceLine" id="cb451-3" title="3"><span class="kw">pwr.t.test</span>(<span class="dt">n=</span><span class="dv">6</span>, <span class="dt">d=</span><span class="fl">1.58</span>, <span class="dt">sig.level=</span><span class="fl">0.05</span>, <span class="dt">type=</span><span class="st">&quot;paired&quot;</span>, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</a></code></pre></div>
<pre><code>## 
##      Paired t test power calculation 
## 
##               n = 6
##               d = 1.58
##       sig.level = 0.05
##           power = 0.867253
##     alternative = two.sided
## 
## NOTE: n is number of *pairs*</code></pre>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb453-1" title="1"><span class="kw">pwr.t.test</span>(<span class="dt">n=</span><span class="dv">8</span>, <span class="dt">d=</span><span class="fl">1.58</span>, <span class="dt">sig.level=</span><span class="fl">0.05</span>, <span class="dt">type=</span><span class="st">&quot;two.sample&quot;</span>, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</a></code></pre></div>
<pre><code>## 
##      Two-sample t test power calculation 
## 
##               n = 8
##               d = 1.58
##       sig.level = 0.05
##           power = 0.8358049
##     alternative = two.sided
## 
## NOTE: n is number in *each* group</code></pre>

<p>#t Distributions {#tdist}</p>
<p>Sample means are a statistical model most appropriate when applied to groups of measured continuous data. Student’s t statistic is a transformation of measured data as a ratio of a sample mean to its standard error.</p>
<p>Therefore, Student’s t distributions are continuous probability models used for comparing the signal to noise ratios of sample means. The t-distribution is used widely in experimental statistics, a) for experiments that compare one or two variables with t-tests, b) for post hoc tests following ANOVA, c) for confidence intervals and d) for testing regression coefficients.</p>
<p>A sample for the variable <span class="math inline">\(Y\)</span> with values <span class="math inline">\(y_1, y_2,...,y_n\)</span>, has a sample mean: <span class="math inline">\(\bar y =\sum_{i=1}^ny_i\)</span>. The degrees of freedom for the sample mean is <span class="math inline">\(df=n-1\)</span>. The sample standard deviation is <span class="math inline">\(s=\sqrt{\frac{\sum_{i=1}^n(y_i-\bar y)^2}{df}}\)</span> and the standard error of the mean for a sample is <span class="math inline">\(sem=\frac{s}{\sqrt n}\)</span></p>
<p>The t-distribution can be scaled in three different ways, depending upon the experimental design:</p>
<p>The t scale units are</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(sem\)</span> for a one sample t test: <span class="math inline">\(t=\frac{(\bar y-\mu)}{sem}\)</span> where <span class="math inline">\(\mu\)</span> is a hypothetical or population mean for comparison.</p></li>
<li><p><span class="math inline">\(sedm\)</span> for a two sample unpaired t test: <span class="math inline">\(t=\frac{\bar y_A-\bar y_B}{sedm}\)</span> where <span class="math inline">\(\bar y_A\)</span> and <span class="math inline">\(\bar y_B\)</span> are the means the uncorrelated groups A and B comparison, <span class="math inline">\(s_p^{2}\)</span> is the pooled variance and <span class="math inline">\(sedm=\sqrt{\frac{s_p{^2}}{n_A}+\frac{s_p{^2}}{n_B}}\)</span> is the standard error for the difference between the two means.</p></li>
<li><p><span class="math inline">\(sem_d\)</span> for a two sample paired t test: <span class="math inline">\(t=\frac{\bar d}{sem_d}\)</span>, where <span class="math inline">\(\bar d\)</span> is the mean of the treatment differences between correlatd pairs whose variance is <span class="math inline">\(s_d^{2}\)</span>, and <span class="math inline">\(sem_d=\sqrt\frac{s_p^{2}}{n}\)</span>.</p></li>
</ol>
</div>
<div id="dt" class="section level2">
<h2><span class="header-section-number">23.5</span> dt</h2>
<p><code>dt</code> is a continous probability density function of the <span class="math inline">\(t\)</span> test statistic.</p>
<p><span class="math display">\[p(t)=\frac{\Gamma(\frac{df+1}{2})}{\sqrt{df\pi}\Gamma(\frac{df}{2})}(1+\frac{t^2}{df})^{-(\frac{df+1}{2})}\]</span></p>
<p>The<code>dt</code>function takes two arguments, a value of <span class="math inline">\(t\)</span> derived from an experimental dataset, and also a value for the <span class="math inline">\(df\)</span> of the sample.</p>
<p>Let’s assume a simple one-sample t test was performed. The sample had 3 independent replicates, and thus 2 degrees of freedom. The value for <span class="math inline">\(t\)</span> calculated from the test is 3.3. The exact probability for that value of <span class="math inline">\(t\)</span> is:</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb455-1" title="1"><span class="kw">dt</span>(<span class="fl">3.3</span>, <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.0216083</code></pre>
<p>That is not a p-value. Alone, a single probability value from a continuous distribution such as this is not particularly useful. But a range of <span class="math inline">\(t\)</span> values can be interesting to model. Note how this is a continuous function, thus we draw a line graph rather than columns.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb457-1" title="1">df &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb457-2" title="2">t &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.001</span>)</a>
<a class="sourceLine" id="cb457-3" title="3">data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">dt=</span><span class="kw">dt</span>(t, df))</a>
<a class="sourceLine" id="cb457-4" title="4">g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x=</span>t, <span class="dt">y=</span>dt))<span class="op">+</span></a>
<a class="sourceLine" id="cb457-5" title="5"><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb457-6" title="6"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb457-7" title="7"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;t&quot;</span>) <span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;p(t)&quot;</span>); g</a></code></pre></div>
<p><img src="jabstb_files/figure-html/unnamed-chunk-252-1.png" width="672" /></p>
<p>A couple of important features of the <span class="math inline">\(t\)</span> probability density function: 1) there is a unique <span class="math inline">\(t\)</span> distribution for every sample size, 2) the t distribution approaches the normal distribution with larger sample sizes.</p>
<p>Here’s a plot comparing a sample size of 3 (<span class="math inline">\(df=2\)</span>), 6 (<span class="math inline">\(df=5\)</span>), 51 (<span class="math inline">\(df=50\)</span>) and the normal distribution. Relative to the normal distribution, the <span class="math inline">\(t\)</span> distributions at these <span class="math inline">\(df\)</span> are “heavy” shouldered. It’s as if a finger is pressing down from the top, spreading the distribution on the sides.</p>
<p>This has the effect of increasing the area under the curves, relative to the normal distribution, at more extreme values on the x-axis.</p>
<p>Increase the <span class="math inline">\(df\)</span> for the blue-colored plot. At what values do you think it best approximates the normal distribution?</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb458-1" title="1">g <span class="op">+</span><span class="st"> </span><span class="kw">stat_function</span>(<span class="dt">fun=</span>dnorm,</a>
<a class="sourceLine" id="cb458-2" title="2">                 <span class="dt">args=</span><span class="kw">list</span>(<span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb458-3" title="3">                 <span class="dt">color=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb458-4" title="4"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun=</span>dt,</a>
<a class="sourceLine" id="cb458-5" title="5">                <span class="dt">args=</span><span class="kw">list</span>(<span class="dt">df=</span><span class="dv">5</span>),</a>
<a class="sourceLine" id="cb458-6" title="6">                <span class="dt">color=</span><span class="st">&quot;blue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb458-7" title="7"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun=</span>dt,</a>
<a class="sourceLine" id="cb458-8" title="8">                <span class="dt">args=</span><span class="kw">list</span>(<span class="dt">df=</span><span class="dv">50</span>),</a>
<a class="sourceLine" id="cb458-9" title="9">                <span class="dt">color=</span><span class="st">&quot;green&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb458-10" title="10"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="fl">2.5</span>, <span class="dt">y=</span><span class="fl">0.35</span>, <span class="dt">label=</span><span class="st">&quot;N(0,1)&quot;</span>, <span class="dt">color=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb458-11" title="11"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="fl">2.5</span>, <span class="dt">y=</span><span class="fl">0.3</span>, <span class="dt">label=</span><span class="st">&quot;t(df=50)&quot;</span>, <span class="dt">color=</span><span class="st">&quot;green&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb458-12" title="12"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="fl">2.5</span>, <span class="dt">y=</span><span class="fl">0.25</span>, <span class="dt">label=</span><span class="st">&quot;t(df=5)&quot;</span>, <span class="dt">color=</span><span class="st">&quot;blue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb458-13" title="13"><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x=</span><span class="fl">2.5</span>, <span class="dt">y=</span><span class="fl">0.2</span>, <span class="dt">label=</span><span class="st">&quot;t(df=2)&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb458-14" title="14"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;t or z&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb458-15" title="15"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="jabstb_files/figure-html/unnamed-chunk-253-1.png" width="480" /></p>
<p>One additional feature of <span class="math inline">\(t\)</span> distributions is the <span class="math inline">\(ncp\)</span> argument, the non-centrality parameter. Full treatment of non-centrality is quite involved and beyond the scope here. Suffice to say that a distribution with <span class="math inline">\(ncp&gt;0\)</span> would differ from a null distribution. Thus, <span class="math inline">\(ncp\)</span> is used when simulating alternative distributions, for example, for the expectation of skewed data in power analysis.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb459-1" title="1">df &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb459-2" title="2">ncp &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb459-3" title="3">t &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="fl">0.001</span>)</a>
<a class="sourceLine" id="cb459-4" title="4">data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">dt=</span><span class="kw">dt</span>(t, df, ncp))</a>
<a class="sourceLine" id="cb459-5" title="5">g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x=</span>t, <span class="dt">y=</span>dt))<span class="op">+</span></a>
<a class="sourceLine" id="cb459-6" title="6"><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb459-7" title="7"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb459-8" title="8"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;t&quot;</span>) <span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;p(t)&quot;</span>); g</a></code></pre></div>
<p><img src="jabstb_files/figure-html/unnamed-chunk-254-1.png" width="672" /></p>
</div>
<div id="pt" class="section level2">
<h2><span class="header-section-number">23.6</span> pt</h2>
<p>If given a <span class="math inline">\(t\)</span> ratio from a comparison and also the <span class="math inline">\(df\)</span> for the test, <code>pt</code> can be used to generate a p-value.</p>
<p>As the cumulative probability function for the <span class="math inline">\(t\)</span> distribution <code>dt</code> returns the area under the curve when given these arguments. Thus, about 96% of the area under the curve is to the left of a <span class="math inline">\(t\)</span> value of 3.3 at <span class="math inline">\(df\)</span>=2, and about 4% of the AUC is to the right of that value.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb460-1" title="1"><span class="kw">pt</span>(<span class="dt">q=</span><span class="fl">3.3</span>, <span class="dt">df=</span><span class="dv">2</span>, <span class="dt">lower.tail =</span>T)</a></code></pre></div>
<pre><code>## [1] 0.9595762</code></pre>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb462-1" title="1"><span class="kw">pt</span>(<span class="dt">q=</span><span class="fl">3.3</span>, <span class="dt">df=</span><span class="dv">2</span>, <span class="dt">lower.tail=</span>F)</a></code></pre></div>
<pre><code>## [1] 0.04042385</code></pre>
<p>That’s precisely what is depicted graphically here, with navy representing the lower tail and green the upper tail of the cumulative function on either side of <span class="math inline">\(t_{df2}=3.3\)</span>:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb464-1" title="1"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb464-2" title="2"><span class="st">  </span><span class="kw">stat_function</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>), <span class="dt">n=</span><span class="dv">150</span>,  <span class="dt">geom=</span><span class="st">&quot;line&quot;</span>, <span class="dt">fun=</span>dt, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">df=</span><span class="dv">2</span>), <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb464-3" title="3"><span class="st">  </span><span class="kw">stat_function</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>), <span class="dt">n=</span><span class="dv">150</span>, <span class="dt">fun=</span>dt, <span class="dt">args=</span><span class="kw">list</span>(<span class="dt">df=</span><span class="dv">2</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="fl">3.3</span>), <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>, <span class="dt">fill=</span> <span class="st">&quot;navy&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb464-4" title="4"><span class="st">  </span><span class="kw">stat_function</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="op">-</span><span class="dv">5</span><span class="op">:</span><span class="dv">5</span>), <span class="dt">n=</span><span class="dv">150</span>, <span class="dt">fun=</span>dt, <span class="dt">args=</span><span class="kw">list</span>(<span class="dt">df=</span><span class="dv">2</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">3.3</span>, <span class="dv">5</span>), <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>, <span class="dt">fill=</span> <span class="st">&quot;green&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb464-5" title="5"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb464-6" title="6"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;t&quot;</span>) <span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;p(t)&quot;</span>)</a></code></pre></div>
<p><img src="jabstb_files/figure-html/unnamed-chunk-256-1.png" width="672" /></p>
</div>
<div id="qt" class="section level2">
<h2><span class="header-section-number">23.7</span> qt</h2>
<p>The inverse cumulative function <code>qt</code> is most useful as a tool to generate critical value limits. This is a particularly important function given it’s use in constructing confidence intervals.</p>
<p>For example, the two sided, 95% critical limits for <span class="math inline">\(t_{df2}\)</span> are:</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb465-1" title="1"><span class="kw">qt</span>(.<span class="dv">025</span>, <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] -4.302653</code></pre>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb467-1" title="1"><span class="kw">qt</span>(<span class="fl">0.025</span>, <span class="dv">2</span>, <span class="dt">lower.tail=</span>F)</a></code></pre></div>
<pre><code>## [1] 4.302653</code></pre>
<p>Whereas each of the one-sided 95% critical limits <span class="math inline">\(t_{df2}\)</span> are:</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb469-1" title="1"><span class="kw">qt</span>(<span class="fl">0.05</span>, <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] -2.919986</code></pre>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb471-1" title="1"><span class="kw">qt</span>(<span class="fl">0.05</span>, <span class="dv">2</span>, <span class="dt">lower.tail=</span>F)</a></code></pre></div>
<pre><code>## [1] 2.919986</code></pre>
<p>The inverse cumulative distribution is shown here:</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb473-1" title="1">df &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb473-2" title="2">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</a>
<a class="sourceLine" id="cb473-3" title="3">data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">qt=</span><span class="kw">qt</span>(x, df))</a>
<a class="sourceLine" id="cb473-4" title="4">g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>qt))<span class="op">+</span></a>
<a class="sourceLine" id="cb473-5" title="5"><span class="st">  </span><span class="kw">geom_line</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb473-6" title="6"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,.<span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb473-7" title="7"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;p&quot;</span>) <span class="op">+</span><span class="kw">ylab</span>(<span class="st">&quot;t&quot;</span>); g</a></code></pre></div>
<p><img src="jabstb_files/figure-html/unnamed-chunk-259-1.png" width="672" /></p>
</div>
<div id="rt" class="section level2">
<h2><span class="header-section-number">23.8</span> rt</h2>
<p>Finally, the <code>rt</code> function can be used to simulate a random sample of t values for a distribution with <span class="math inline">\(df\)</span> degrees of freedom.</p>
<p>For example, here are 5 t values from a <span class="math inline">\(df2\)</span> and another 4 from <span class="math inline">\(df20\)</span>. You’re more likely to get crazy outliers from the former rather than the latter.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb474-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb474-2" title="2"><span class="kw">rt</span>(<span class="dv">5</span>, <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1]  0.5514286 -0.2275454  4.1377301 -1.1483718 -0.4579998</code></pre>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb476-1" title="1"><span class="kw">rt</span>(<span class="dv">5</span>, <span class="dv">20</span>)</a></code></pre></div>
<pre><code>## [1] -0.28197205 -0.06705986 -0.28785784  0.27207442  1.66794394</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ttests.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simcorrelation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["jabstb.pdf", "jabstb.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
