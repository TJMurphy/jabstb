<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>JABSTB: Statistical Design and Analysis of Experiments with R</title>
  <meta name="description" content="Experimental biostatistics using R.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="JABSTB: Statistical Design and Analysis of Experiments with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Experimental biostatistics using R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="JABSTB: Statistical Design and Analysis of Experiments with R" />
  
  <meta name="twitter:description" content="Experimental biostatistics using R." />
  

<meta name="author" content="TJ Murphy PhD, Department of Pharmacology, School of Medicine, Emory University, Atlanta, GA biostats538@gmail.com">


<meta name="date" content="2018-12-23">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="error.html">
<link rel="next" href="data.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">JABSTB</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i><b>1</b> About the author</a></li>
<li class="chapter" data-level="2" data-path="history.html"><a href="history.html"><i class="fa fa-check"></i><b>2</b> A Brief History of Experimental Design</a></li>
<li class="chapter" data-level="3" data-path="bigpic.html"><a href="bigpic.html"><i class="fa fa-check"></i><b>3</b> The Big Picture</a><ul>
<li class="chapter" data-level="3.1" data-path="bigpic.html"><a href="bigpic.html#what-are-experimental-statistics"><i class="fa fa-check"></i><b>3.1</b> What are experimental statistics?</a><ul>
<li class="chapter" data-level="3.1.1" data-path="bigpic.html"><a href="bigpic.html#descriptive-modeling"><i class="fa fa-check"></i><b>3.1.1</b> Descriptive modeling</a></li>
<li class="chapter" data-level="3.1.2" data-path="bigpic.html"><a href="bigpic.html#statistical-inference"><i class="fa fa-check"></i><b>3.1.2</b> Statistical inference</a></li>
<li class="chapter" data-level="3.1.3" data-path="bigpic.html"><a href="bigpic.html#experimental-design"><i class="fa fa-check"></i><b>3.1.3</b> Experimental design</a></li>
<li class="chapter" data-level="3.1.4" data-path="bigpic.html"><a href="bigpic.html#statistics-as-an-anti-bias-framework"><i class="fa fa-check"></i><b>3.1.4</b> Statistics as an anti-bias framework</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>4</b> Statistical Sampling</a><ul>
<li class="chapter" data-level="4.1" data-path="sampling.html"><a href="sampling.html#experimental-units"><i class="fa fa-check"></i><b>4.1</b> Experimental units</a><ul>
<li class="chapter" data-level="4.1.1" data-path="sampling.html"><a href="sampling.html#a-simple-test-to-define-the-experimental-unit"><i class="fa fa-check"></i><b>4.1.1</b> A simple test to define the experimental unit</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sampling.html"><a href="sampling.html#independent-replicates"><i class="fa fa-check"></i><b>4.2</b> Independent Replicates</a><ul>
<li class="chapter" data-level="4.2.1" data-path="sampling.html"><a href="sampling.html#a-simple-test-for-independence"><i class="fa fa-check"></i><b>4.2.1</b> A simple test for independence</a></li>
<li class="chapter" data-level="4.2.2" data-path="sampling.html"><a href="sampling.html#some-replication-examples"><i class="fa fa-check"></i><b>4.2.2</b> Some replication examples</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sampling.html"><a href="sampling.html#random-process"><i class="fa fa-check"></i><b>4.3</b> Random process</a></li>
<li class="chapter" data-level="4.4" data-path="sampling.html"><a href="sampling.html#statistically-valid-samples"><i class="fa fa-check"></i><b>4.4</b> Statistically valid samples</a><ul>
<li class="chapter" data-level="4.4.1" data-path="sampling.html"><a href="sampling.html#select-random-subjects"><i class="fa fa-check"></i><b>4.4.1</b> Select random subjects</a></li>
<li class="chapter" data-level="4.4.2" data-path="sampling.html"><a href="sampling.html#randomize-to-sequence"><i class="fa fa-check"></i><b>4.4.2</b> Randomize to sequence</a></li>
<li class="chapter" data-level="4.4.3" data-path="sampling.html"><a href="sampling.html#randomize-to-location"><i class="fa fa-check"></i><b>4.4.3</b> Randomize to location</a></li>
<li class="chapter" data-level="4.4.4" data-path="sampling.html"><a href="sampling.html#randomize-to-block"><i class="fa fa-check"></i><b>4.4.4</b> Randomize to block</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sampling.html"><a href="sampling.html#independence-of-replicates"><i class="fa fa-check"></i><b>4.5</b> Independence of replicates</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hypotheses.html"><a href="hypotheses.html"><i class="fa fa-check"></i><b>5</b> Framing statistical hypotheses</a><ul>
<li class="chapter" data-level="5.1" data-path="hypotheses.html"><a href="hypotheses.html#the-decision-process"><i class="fa fa-check"></i><b>5.1</b> The decision process</a></li>
<li class="chapter" data-level="5.2" data-path="hypotheses.html"><a href="hypotheses.html#popper-and-falsification"><i class="fa fa-check"></i><b>5.2</b> Popper and falsification</a></li>
<li class="chapter" data-level="5.3" data-path="hypotheses.html"><a href="hypotheses.html#statistical-hypothesis-rubric"><i class="fa fa-check"></i><b>5.3</b> Statistical hypothesis rubric</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="error.html"><a href="error.html"><i class="fa fa-check"></i><b>6</b> Error</a><ul>
<li class="chapter" data-level="6.1" data-path="error.html"><a href="error.html#setting-type-1-and-type-2-error-thresholds"><i class="fa fa-check"></i><b>6.1</b> Setting type 1 and type 2 error thresholds</a><ul>
<li class="chapter" data-level="6.1.1" data-path="error.html"><a href="error.html#setting-alpha-the-type-1-error"><i class="fa fa-check"></i><b>6.1.1</b> Setting alpha-the type 1 error</a></li>
<li class="chapter" data-level="6.1.2" data-path="error.html"><a href="error.html#power-setting-beta-the-type-2-error"><i class="fa fa-check"></i><b>6.1.2</b> Power: Setting beta-the type 2 error</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="error.html"><a href="error.html#striking-the-right-balance"><i class="fa fa-check"></i><b>6.2</b> Striking the right balance</a></li>
<li class="chapter" data-level="6.3" data-path="error.html"><a href="error.html#false-discovery-rate"><i class="fa fa-check"></i><b>6.3</b> False discovery rate</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="pvalues.html"><a href="pvalues.html"><i class="fa fa-check"></i><b>7</b> P Values</a><ul>
<li class="chapter" data-level="7.1" data-path="pvalues.html"><a href="pvalues.html#how-p-values-are-calculated"><i class="fa fa-check"></i><b>7.1</b> How p-values are calculated</a></li>
<li class="chapter" data-level="7.2" data-path="pvalues.html"><a href="pvalues.html#how-p-values-should-be-interpreted"><i class="fa fa-check"></i><b>7.2</b> How p-values should be interpreted</a></li>
<li class="chapter" data-level="7.3" data-path="pvalues.html"><a href="pvalues.html#interpretation"><i class="fa fa-check"></i><b>7.3</b> Interpretation</a></li>
<li class="chapter" data-level="7.4" data-path="pvalues.html"><a href="pvalues.html#criticisms-of-p-values"><i class="fa fa-check"></i><b>7.4</b> Criticisms of p-values</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>8</b> Data Classification</a><ul>
<li class="chapter" data-level="8.1" data-path="data.html"><a href="data.html#dependent-and-independent-variables"><i class="fa fa-check"></i><b>8.1</b> Dependent and independent variables</a><ul>
<li class="chapter" data-level="8.1.1" data-path="data.html"><a href="data.html#when-there-is-no-independent-variable"><i class="fa fa-check"></i><b>8.1.1</b> When there is no independent variable</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="data.html"><a href="data.html#discrete-or-continuous-variables"><i class="fa fa-check"></i><b>8.2</b> Discrete or continuous variables</a><ul>
<li class="chapter" data-level="8.2.1" data-path="data.html"><a href="data.html#measured-variables"><i class="fa fa-check"></i><b>8.2.1</b> Measured variables</a></li>
<li class="chapter" data-level="8.2.2" data-path="data.html"><a href="data.html#discrete-categorical-and-ordinal-variables"><i class="fa fa-check"></i><b>8.2.2</b> Discrete categorical and ordinal variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html"><i class="fa fa-check"></i><b>9</b> Statistics for Categorical Data</a><ul>
<li class="chapter" data-level="9.1" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#types-of-categorical-data"><i class="fa fa-check"></i><b>9.1</b> Types of categorical data</a><ul>
<li class="chapter" data-level="9.1.1" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#proportions"><i class="fa fa-check"></i><b>9.1.1</b> Proportions</a></li>
<li class="chapter" data-level="9.1.2" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#frequencies"><i class="fa fa-check"></i><b>9.1.2</b> Frequencies</a></li>
<li class="chapter" data-level="9.1.3" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#associations"><i class="fa fa-check"></i><b>9.1.3</b> Associations</a></li>
<li class="chapter" data-level="9.1.4" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#statistics-covered-here"><i class="fa fa-check"></i><b>9.1.4</b> Statistics Covered Here</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#exact-v-asymptotic-calculations-of-p-values"><i class="fa fa-check"></i><b>9.2</b> Exact v Asymptotic Calculations of p-values</a><ul>
<li class="chapter" data-level="9.2.1" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#choosing-exact-or-asymptotic"><i class="fa fa-check"></i><b>9.2.1</b> Choosing exact or asymptotic</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#overview-of-the-types-of-hypothesis-testing"><i class="fa fa-check"></i><b>9.3</b> Overview of the types of hypothesis testing</a><ul>
<li class="chapter" data-level="9.3.1" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#proportion-analysis"><i class="fa fa-check"></i><b>9.3.1</b> Proportion analysis</a></li>
<li class="chapter" data-level="9.3.2" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#goodness-of-fit-testing"><i class="fa fa-check"></i><b>9.3.2</b> Goodness of fit testing</a></li>
<li class="chapter" data-level="9.3.3" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#contingency-analysis"><i class="fa fa-check"></i><b>9.3.3</b> Contingency Analysis</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#comparing-proportions"><i class="fa fa-check"></i><b>9.4</b> Comparing proportions</a><ul>
<li class="chapter" data-level="9.4.1" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#a-mouse-t-cell-pilot-experiment-the-cytokine-inducible-antigen-gradstudin"><i class="fa fa-check"></i><b>9.4.1</b> A Mouse T Cell Pilot Experiment: The Cytokine-inducible antigen gradstudin</a></li>
<li class="chapter" data-level="9.4.2" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#calculating-proportions"><i class="fa fa-check"></i><b>9.4.2</b> Calculating Proportions</a></li>
<li class="chapter" data-level="9.4.3" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#what-a-proportion-estimates"><i class="fa fa-check"></i><b>9.4.3</b> What A Proportion Estimates</a></li>
<li class="chapter" data-level="9.4.4" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#confidence-intervals-of-proportions"><i class="fa fa-check"></i><b>9.4.4</b> Confidence Intervals of Proportions</a></li>
<li class="chapter" data-level="9.4.5" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#a-one-sample-proportion-test"><i class="fa fa-check"></i><b>9.4.5</b> A One-Sample Proportion Test</a></li>
<li class="chapter" data-level="9.4.6" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#comparing-two-proportions"><i class="fa fa-check"></i><b>9.4.6</b> Comparing Two Proportions</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#exact-tests-for-two-proportions"><i class="fa fa-check"></i><b>9.5</b> Exact tests for two proportions</a></li>
<li class="chapter" data-level="9.6" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#goodness-of-fit-tests"><i class="fa fa-check"></i><b>9.6</b> Goodness of fit Tests</a><ul>
<li class="chapter" data-level="9.6.1" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#an-exact-goodness-of-fit-test"><i class="fa fa-check"></i><b>9.6.1</b> An Exact Goodness of Fit test</a></li>
<li class="chapter" data-level="9.6.2" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#an-approximate-goodness-of-fit-test"><i class="fa fa-check"></i><b>9.6.2</b> An Approximate Goodness of Fit test</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#contingency-testing"><i class="fa fa-check"></i><b>9.7</b> Contingency Testing</a><ul>
<li class="chapter" data-level="9.7.1" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#intepretation-of-contingency-results"><i class="fa fa-check"></i><b>9.7.1</b> Intepretation of Contingency Results</a></li>
<li class="chapter" data-level="9.7.2" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#write-up-3"><i class="fa fa-check"></i><b>9.7.2</b> Write Up</a></li>
<li class="chapter" data-level="9.7.3" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#interpretation-of-chi2-output"><i class="fa fa-check"></i><b>9.7.3</b> Interpretation of <span class="math inline">\(\chi^2\)</span> output</a></li>
<li class="chapter" data-level="9.7.4" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#write-up-4"><i class="fa fa-check"></i><b>9.7.4</b> Write Up</a></li>
<li class="chapter" data-level="9.7.5" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#which-contingency-test-is-best"><i class="fa fa-check"></i><b>9.7.5</b> Which contingency test is best?</a></li>
<li class="chapter" data-level="9.7.6" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#higher-dimension-contingency-analysis"><i class="fa fa-check"></i><b>9.7.6</b> Higher dimension contingency analysis</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#doing-a-priori-power-analysis-for-proportion-tests"><i class="fa fa-check"></i><b>9.8</b> Doing <em>a priori</em> power analysis for proportion tests</a></li>
<li class="chapter" data-level="9.9" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#power-analysis-functions-for-proportion-tests"><i class="fa fa-check"></i><b>9.9</b> Power analysis functions for proportion tests</a></li>
<li class="chapter" data-level="9.10" data-path="statistics-for-categorical-data.html"><a href="statistics-for-categorical-data.html#graphing-proportions"><i class="fa fa-check"></i><b>9.10</b> Graphing Proportions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">JABSTB: Statistical Design and Analysis of Experiments with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pvalues" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> P Values</h1>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<p>You’ll see soon enough that when you run a statistical test function in R, it generates list objects that are chock full of useful information.</p>
<p>Invariably, the researcher’s eyes will go right to the p-value. This is understandable, since most researchers have been trained to associate their own success with a p-value falling below some pre-set <span class="math inline">\(\alpha\)</span>. Who could really blame them for peeking at the p-values first?</p>
<p>The p-value is an instrument by which an important decision will be made. As such, it is worth understanding how that instrument works.</p>
<p>Hypothesis-driven experiments are designed to test the null hypothesis. That null will be rejected if the effect size is large enough. Extreme effect sizes correspond to extreme values of test statistics.</p>
<p><strong>A p-value is the probability that a given test statistic value could be as large as it is, or even more extreme, if the null hypothesis were actually true.</strong></p>
<p>In other words, the p-value is an error probability. It is also a random variable. Which means that it is always possible for an experiment to generate an extreme test statistic by simple random chance. The p-value asserts the probability that this is the case.</p>
<p>One of the reasons I like using R for experimental statistics is that R makes it easy to simulate p-values. Because of that you build an intuitive sense for how they operate. R makes it easy to understand p-values.</p>
<div id="how-p-values-are-calculated" class="section level2">
<h2><span class="header-section-number">7.1</span> How p-values are calculated</h2>
<p>You can think of test statistics as a transformation of sample data. There are many test statistics. The one to use for a given data set depends on the experimental design. Each test statistic has a probability distribution. P-values are derived from the probability distributions of these test statistics and serve as a way to standardize the decision making process irrespective of the experimental design and test statistic.</p>
<p>Probably the simplest test statistic to understand is the z-score. The z-score is a transformation of data from whatever scale it is on, to a standard normal scale. It’s usually appropriate for continuous data.
<span class="math display">\[z_i=\frac{y_i-\mu}{\sigma}\]</span>
Let’s say we have single blood glucose value of 122 mg/dl. What is its p-value? Is the z-score corresponding to that glucose value too extreme to belong in the null distribution of z-scores?</p>
<p>First, the blood glucose values is transformed into a z-score. We’ll say the mean and standard deviation of blood glucose in the sampled population is 100 and 10 mg/dl, respectively. The z-score for a value of 122 is therefore:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">z &lt;-<span class="st"> </span>(<span class="dv">122-100</span>)<span class="op">/</span><span class="dv">10</span>; z</a></code></pre></div>
<pre><code>## [1] 2.2</code></pre>
<p>z-score units are in standard deviations. Thus, a z-score value of 2.2 indicates it is 2.2 standard deviation units greater than the standard normal mean (which is zero, of course).</p>
<p>Next, we’ll pass that z-score value of 2.2 into the standard normal density function, <code>pnorm</code>. We cause the function to produce a p-value for that z-score by using a <code>lower.tail=FALSE</code> argument:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">pnorm</span>(<span class="fl">2.2</span>, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">1</span>, <span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## [1] 0.01390345</code></pre>
<p>In the z probability distribution below, the blue shaded region illustrates what this p-value looks like. The p-value covers the probabilities for z-score values of 2.2 and higher. The p-value is thus the area under the curve for the z probability distribution for that value of z and for more extreme values.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">zscore =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)), <span class="kw">aes</span>(zscore)) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm,</a>
<a class="sourceLine" id="cb26-4" title="4">                <span class="dt">xlim=</span> <span class="kw">c</span>(<span class="fl">2.2</span>, <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb26-5" title="5">                <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;blue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;p(z)&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb26-7" title="7"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="jabstb_files/figure-html/unnamed-chunk-20-1.png" width="480" /></p>
</div>
<div id="how-p-values-should-be-interpreted" class="section level2">
<h2><span class="header-section-number">7.2</span> How p-values should be interpreted</h2>
<p>The question that’s ringing in your ears right now is, “Is a z-score value of 2.2 so extreme we can reject that it belongs to the null distribution of z-scores?”</p>
<p>The answer to that question depends upon what threshold you deem is too extreme. Remember, a threshold is our tolerance for error; in this case, for type 1 error.</p>
<p>If the threshold for an acceptable risk of type 1 error is 5% (<span class="math inline">\(p &lt; 0.05\)</span>), then let’s see how those look on the z-distribution.</p>
<p>First, let’s calculate z-scores corresponding the area outside 95% of the z-scores. Since extreme z-scores can lay on both the right and the left sides of the z-distribution, which is symmetrical. Therefore we split the 5% in half and use the quantile function <code>qnorm</code> to calculate z-scores for each:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">qnorm</span>(<span class="fl">0.025</span>, <span class="dt">lower.tail =</span> F)</a></code></pre></div>
<pre><code>## [1] 1.959964</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">qnorm</span>(<span class="fl">0.025</span>, <span class="dt">lower.tail =</span> T)</a></code></pre></div>
<pre><code>## [1] -1.959964</code></pre>
<p>Thus, the 95% confidence limits for the z-scores are ~ +/- 1.96, almost 2 standard deviations from the mean. We plug those values as limits into our plot:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">zscore =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)), <span class="kw">aes</span>(zscore)) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm,</a>
<a class="sourceLine" id="cb31-4" title="4">                <span class="dt">xlim=</span> <span class="kw">c</span>(<span class="fl">1.96</span>, <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb31-5" title="5">                <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb31-6" title="6"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm,</a>
<a class="sourceLine" id="cb31-7" title="7">                <span class="dt">xlim=</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.96</span>, <span class="dv">-5</span>),</a>
<a class="sourceLine" id="cb31-8" title="8">                <span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb31-9" title="9"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;p(z)&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb31-10" title="10"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="jabstb_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Any z-score values corresponding to the red-shaded areas would be deemed too extreme to belong to the null. The limit on the right side is 1.96. Therefore, yes, a z-score of 2.2 (<span class="math inline">\(p=0.0139\)</span>) is too extreme to belong to the standard null distribution.</p>
</div>
<div id="interpretation" class="section level2">
<h2><span class="header-section-number">7.3</span> Interpretation</h2>
<p>Every time we do an experiment we operate on the assumption that our data represent the null. This is analogous to considering a defendant innocent until proven guilty. So we think of test statistic values we calculate from our data, unless proven otherwise, as belonging to the null distribution of test statistic values.</p>
<p>The interpretation of <span class="math inline">\(p=0.0139\)</span> is the probability that z-score (and its corresponding glucose value of 122 mg/dl) are that large by chance is 0.0139. There’s about a 1.4% chance we are making an error by rejecting the null that it belongs to the <span class="math inline">\(N(100, 10)\)</span>.</p>
</div>
<div id="criticisms-of-p-values" class="section level2">
<h2><span class="header-section-number">7.4</span> Criticisms of p-values</h2>
<p>There are several criticisms of p-values, many of which are legitimate. I’ll address a few key ones here.</p>
<ol style="list-style-type: decimal">
<li><em>They are too confusing, nobody understands them.</em>
I get that. I confess that p-values are a struggle to teach in a way that’s simple and memorable. Especially for students who only consider statistics episodically, perhaps a few times a year.</li>
</ol>
<p>This year I’m teaching this with a bit more emphasis upon Popper and the merits of null hypothesis falsification as the cornerstone of the scientific method and how p-values fit into that tradition.</p>
<p>Here it is: All statistical tests (the ones I teach in this course) are tests of the null hypothesis. When the test result is extreme, we reject the null. The p-value is the probability we’re rejecting the null in error.</p>
<p>Despite the merit of this particular criticism, p-values are not going away. They are an important inferential tool used by most biological scientists, even if poorly understood and implemented.</p>
<p>Like any tool in the lab, it is incumbant upon the researcher to learn how it works. I think a great way to get a better intuitive understanding for p-values is to play around with the various test statistic probability and quantile distributions in R (<code>pnorm, qnorm, pt, qt, pf, pf, pchisq, qchisq, psignrank, qsignrank</code> etc). Use them to run various scenarios, plot them out…get a sense for how the tools work by using them.</p>
<ol start="2" style="list-style-type: decimal">
<li><em>p-Values poorly protect from false discovery</em>
This is undoubtedly true. Since David Colquhoun goes over this in <a href="http://rsos.royalsocietypublishing.org/content/1/3/140216">blistering detail</a> I won’t repeat his thorough analysis here. The researcher MUST operate with skepticism about p-values.</li>
</ol>
<p>Since Colquhoun’s argument is entirely based in simulation it also inspires an approach for dealing with this problem. Through simulation <em>a priori</em>, a researcher can design and run experiments <em>in silico</em> that strikes the right balance between the threshold levels she can control (eg, <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>) and feasibility in a way that best minimizes the risk of false discovery. Before ever lifting a finger in the lab.</p>
<p>This criticism explains why I am such a strong advocate of Monte Carlo simulation in experimental design. With software like R, there really is no excuse anymore for the researcher being a victim of this problem.</p>
<ol start="3" style="list-style-type: decimal">
<li><em>p-Values aren’t the probability I’m interested in</em>
Researchers who raise this criticism generally are interested in something the p-value was never designed to deliver: the probability that their experiment worked.</li>
</ol>
<p>A p-value doesn’t provide that information because it is an error probability. Specifically, it is the probability of making a type 1 error.</p>
<p>For these researchers, embracing Bayesian statistics is probably a better option. I don’t teach Bayesian statistics in this course for a couple of reasons, but mostly because I don’t understand it well enough to teach it, and I don’t see how it offers a superior approach for experimental research.</p>
<ol start="4" style="list-style-type: decimal">
<li><em>People use p-values as evidence for the magnitude of an effect.</em>
Sure, but they are wrong. This is more a criticism of the people who use p-values, and not the p-value. But the criticism raises the point that it is a mistake to rely solely on a p-value to interpret the outcome of an experiment.</li>
</ol>
<p>A p-value&lt;0.05 only means that there is less than 1 out of 20 chance of having detected an extreme effect when the null is true. A low p-value doesn’t provide evidence that the treatment effect is real. As a result, a p-value can’t provide any information about the magnitude of the treatment effect.</p>
<p>Neither is a low p-value synonymous with scientific significance. A simple example of this comes from 2 way ANOVA F test analysis. When the test suggests a postive result for an interaction effect, that finding supercedes the main effects. Thus, should any main effects also have low p-values they are not scientifically meaningful.</p>
<p>Researchers <a href="https://www.nature.com/articles/nmeth.4210">should therefore analyze p-values in conjunction with other parameters</a>, such as effect sizes and the confidence intervals.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="error.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["jabstb.pdf", "jabstb.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
